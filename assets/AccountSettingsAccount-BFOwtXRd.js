import{_ as X}from"./AppTextField-CLvxn6_C.js";import{r as u,O as ie,f as q,o as y,e as l,b as a,l as p,ap as F,s as w,t as E,aF as Z,d as f,c as N,F as R,h as O,a9 as P,a2 as z,aY as ce,bb as me,bd as pe,E as fe}from"./index-BxU12KgC.js";import{$ as G}from"./api-Ba7n58ZI.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as i,V as h}from"./VRow--HD-L7TS.js";import{V as ae}from"./VCard-CslEgE47.js";import{V as le}from"./VSnackbar-B_Z8K1Tu.js";import{V as te}from"./VForm-BT--ttCz.js";import{V as I}from"./VCardText-CTVtF3nt.js";import{V as be,a as ve}from"./VList-BmPgoNUJ.js";import{_ as ge}from"./ConfirmDialog-DSdk1bFb.js";import{f as _e,b as Ve,a as ye,n as J}from"./images-DNnnEzYI.js";import{V as we}from"./VAvatar-BhdHmQHY.js";import{V as M}from"./VSheet-CEKxmovY.js";import{V as Q}from"./form-BXvCDZ_7.js";import{V as W}from"./VChip-Co1dQI_y.js";import{V as ke}from"./VFileInput-rSMX_oTq.js";const xe={__name:"AccountSettingsSecurity",setup(se){const V=u(!1),k=u(!1),x=u(!1),v=u(""),b=u(""),g=u(""),$=["Minimum 8 characters long - the more, the better","At least one lowercase character","At least one number, symbol, or whitespace character"];u(!1);const _=u(!1),A=u(""),U=u("deep-purple-accent-4"),t=u(!1);async function L(c){if(c&&c.status&&!c.ok)try{return await c.json()}catch{return{message:`API Error (Status ${c.status})`}}return{message:(c==null?void 0:c.message)||"Network error"}}const B=ie(()=>({password:b.value,password_confirmation:g.value,old_password:v.value})),T=async()=>{if(!b.value||!g.value){A.value="Please fill all required fields.",U.value="error",_.value=!0;return}if(b.value!==g.value){A.value="Passwords do not match.",U.value="error",_.value=!0;return}t.value=!0;try{await G("/v1/users/updatePassword",{method:"PATCH",body:B.value,onResponseError({response:c}){var m,j;const n=((m=c==null?void 0:c._data)==null?void 0:m.errors)||{},C=Object.values(n).flat().filter(Boolean).join(`
`);A.value=C||(((j=c==null?void 0:c._data)==null?void 0:j.message)??"Failed to change password."),U.value="error",_.value=!0}}),A.value="Password changed successfully.",U.value="success",_.value=!0,b.value="",g.value="",v.value=""}catch(c){const n=await L(c);A.value=(n==null?void 0:n.message)||"An unexpected error occurred.",U.value="error",_.value=!0}finally{t.value=!1}};return(c,n)=>{const C=X;return y(),q(h,null,{default:l(()=>[a(i,{cols:"12"},{default:l(()=>[a(ae,{title:"Change Password"},{default:l(()=>[a(le,{modelValue:p(_),"onUpdate:modelValue":n[0]||(n[0]=m=>F(_)?_.value=m:null),timeout:2400,color:p(U),class:"elevation-24",location:"top right"},{default:l(()=>[w(E(p(A)),1)]),_:1},8,["modelValue","color"]),a(te,{onSubmit:Z(T,["prevent"])},{default:l(()=>[a(I,{class:"pt-0"},{default:l(()=>[a(h,null,{default:l(()=>[a(i,{cols:"12",md:"6"},{default:l(()=>[a(C,{modelValue:p(v),"onUpdate:modelValue":n[1]||(n[1]=m=>F(v)?v.value=m:null),type:p(V)?"text":"password","append-inner-icon":p(V)?"tabler-eye-off":"tabler-eye",label:"Current Password",autocomplete:"on",placeholder:"············","onClick:appendInner":n[2]||(n[2]=m=>V.value=!p(V))},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1}),a(h,null,{default:l(()=>[a(i,{cols:"12",md:"6"},{default:l(()=>[a(C,{modelValue:p(b),"onUpdate:modelValue":n[3]||(n[3]=m=>F(b)?b.value=m:null),type:p(k)?"text":"password","append-inner-icon":p(k)?"tabler-eye-off":"tabler-eye",label:"New Password",autocomplete:"on",placeholder:"············","onClick:appendInner":n[4]||(n[4]=m=>k.value=!p(k))},null,8,["modelValue","type","append-inner-icon"])]),_:1}),a(i,{cols:"12",md:"6"},{default:l(()=>[a(C,{modelValue:p(g),"onUpdate:modelValue":n[5]||(n[5]=m=>F(g)?g.value=m:null),type:p(x)?"text":"password","append-inner-icon":p(x)?"tabler-eye-off":"tabler-eye",label:"Confirm New Password",autocomplete:"on",placeholder:"············","onClick:appendInner":n[6]||(n[6]=m=>x.value=!p(x))},null,8,["modelValue","type","append-inner-icon"])]),_:1})]),_:1})]),_:1}),a(I,null,{default:l(()=>[n[7]||(n[7]=f("h6",{class:"text-h6 text-medium-emphasis mb-4"}," Password Requirements: ",-1)),a(be,{class:"card-list"},{default:l(()=>[(y(),N(R,null,O($,m=>a(ve,{key:m,title:m,class:"text-medium-emphasis"},{prepend:l(()=>[a(P,{size:"10",icon:"tabler-circle-filled"})]),_:2},1032,["title"])),64))]),_:1})]),_:1,__:[7]}),a(I,{class:"d-flex flex-wrap gap-4"},{default:l(()=>[a(z,{type:"submit",loading:p(t)},{default:l(()=>n[8]||(n[8]=[w("Save changes")])),_:1,__:[8]},8,["loading"]),a(z,{type:"reset",color:"secondary",variant:"tonal"},{default:l(()=>n[9]||(n[9]=[w(" Reset ")])),_:1,__:[9]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},Je=ee(xe,[["__scopeId","data-v-4bc0447d"]]),Ae={class:"d-flex flex-column justify-center gap-4"},Ue={class:"d-flex flex-wrap gap-4"},Ce={class:"d-flex align-center gap-2"},Se={key:0,class:"mb-2"},Pe={key:1,class:"text-caption mb-2"},Ne={class:"d-flex align-center gap-2"},he={class:"d-flex align-center gap-2"},Ie={__name:"AccountSettingsAccount",setup(se){const V=u(!1),k=u(""),x=u("deep-purple-accent-4"),v=u([]),b=u([]),g=u([]),$={avatarImg:ce,firstName:"john",lastName:"Doe",email:"johnDoe@example.com",org:"Pixinvent",phone:"+1 (917) 543-9876",address:"123 Main St, New York, NY 10001",state:"New York",zip:"10001",country:"USA",language:"English",timezone:"(GMT-11:00) International Date Line West",currency:"USD"},_=u(),A=u(!1),U=u(structuredClone($)),t=me({consultant:{image:"",attachments:[],name:"",license_number:"",specialization:"",qualification:""},address:{city:"",district:"",street:"",building_number:"",additional_number:"",postal_code:"",short_address:""},bank:{account_holder_name:"",account_number:"",bank_name:""}}),L=u(""),B=u(null),T=u(null),c=u(!1),n=u(""),C=u(!1),m=u(0);function j(d){if(console.log(d),c.value)return;const e=(d==null?void 0:d.data)??d??{};n.value=e.logo??"",t.consultant.image=e.logo??"",U.value.avatarImg=e.logo,t.consultant.name=e.name??"",t.consultant.license_number=e.license_number??"",t.consultant.specialization=e.specialization??"",t.consultant.qualification=e.qualification??"";const o=e.address||{};t.address.city=o.city??"",t.address.district=o.district??"",t.address.street=o.street??"",t.address.building_number=o.building_number??"",t.address.additional_number=o.additional_number??"",t.address.postal_code=o.postal_code??"",t.address.short_address=o.short_address??"";const S=e.bank_account||{};t.bank.account_holder_name=S.account_holder_name??"",t.bank.account_number=S.account_number??"",t.bank.bank_name=S.bank_name??"",Y(e.attachments),console.log(b.value),console.log(e.attachments),c.value=!0}function Y(d){const e=Array.isArray(d)?d:[];b.value=e.map(o=>typeof o=="string"?{id:null,name:J(o),url:o}:{id:o.id??null,name:o.name||o.filename||J(o.url||o.link||""),url:o.url||o.link||null})}const H=pe();console.log(H.user.consultant,"user in the setting store");const K=async()=>{var e;const d=await G(`/v1/consultants/${(e=H.user.consultant)==null?void 0:e.id}`).catch(o=>console.log(o));T.value=d==null?void 0:d.data,j(d)};fe(K);async function oe(d){L.value=await Ve(d.target.files[0]),B.value=await ye(d.target.files[0]),console.log(B.value),U.value.avatarImg=URL.createObjectURL(d.target.files[0]),n.value=URL.createObjectURL(d.target.files[0])}function ne(d){const e=b.value.splice(d,1)[0];e&&g.value.push(e)}async function ue(){var S,s;C.value=!0;const d=u({});t.consultant.image=B.value;try{t.consultant.attachments=(S=v.value)!=null&&S.length?await _e(v.value):[],console.log("form attatachment"),console.log(t.consultant.attachments)}catch(r){console.error("Error encoding attachments",r),t.consultant.attachments=[]}const e=b.value,o=g.value;t.consultant.existing_attachments=e.map(r=>r.id??r.url).filter(Boolean),t.consultant.removed_existing_attachments=o.map(r=>r.id??r.url).filter(Boolean);try{const r=await G("/v1/consultants",{method:"POST",body:t,onResponseError({response:re}){d.value=re._data.errors;const de=Object.values(d.value).flat().filter(Boolean).join(`
`);k.value=de||"An error occurred while saving the consultant.",x.value="error",V.value=!0}}),D=((s=r==null?void 0:r.data)==null?void 0:s.attachments)??(r==null?void 0:r.attachments);D?Y(D):(c.value=!1,await K()),v.value=[],g.value=[],m.value++,k.value="saved successfully!",x.value="success",V.value=!0}catch(r){console.error(r),k.value="An error occurred while saving the consultant.",x.value="error",V.value=!0}finally{C.value=!1}}return(d,e)=>{const o=X,S=ge;return y(),N(R,null,[a(h,null,{default:l(()=>[a(i,{cols:"12"},{default:l(()=>[a(ae,null,{default:l(()=>[a(I,{class:"d-flex"},{default:l(()=>[a(le,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=s=>V.value=s),timeout:2e3,color:x.value,class:"elevation-24",location:"top right"},{default:l(()=>[w(E(k.value),1)]),_:1},8,["modelValue","color"])]),_:1}),a(I,{class:"pt-0"},{default:l(()=>[a(te,{class:"mt-0",onSubmit:Z(ue,["prevent"])},{default:l(()=>[a(I,{class:"d-flex"},{default:l(()=>[a(we,{rounded:"",size:"100",class:"me-6",image:n.value},null,8,["image"]),f("form",Ae,[f("div",Ue,[a(z,{color:"primary",size:"small",onClick:e[1]||(e[1]=s=>{var r;return(r=_.value)==null?void 0:r.click()})},{default:l(()=>[a(P,{icon:"tabler-cloud-upload",class:"d-sm-none"}),e[18]||(e[18]=f("span",{class:"d-none d-sm-block"},"Upload new photo",-1))]),_:1,__:[18]}),f("input",{ref_key:"refInputEl",ref:_,type:"file",name:"file",accept:".jpeg,.png,.jpg,GIF",hidden:"",onInput:oe},null,544)]),e[19]||(e[19]=f("p",{class:"text-body-1 mb-0"}," Allowed JPG, GIF or PNG. Max size of 800K ",-1))])]),_:1}),a(h,null,{default:l(()=>[a(i,{cols:"12",class:"mt-0"},{default:l(()=>[a(M,{variant:"flat",class:"section-bar bg-grey-lighten-3"},{default:l(()=>[f("div",Ce,[a(P,{icon:"tabler-user-check"}),e[20]||(e[20]=f("span",{class:"text-subtitle-1 section-title"},"Consultant",-1)),e[21]||(e[21]=f("span",{class:"required-star","aria-label":"required"},"*",-1))])]),_:1})]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.consultant.name,"onUpdate:modelValue":e[2]||(e[2]=s=>t.consultant.name=s),label:"Consultant Name"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.consultant.license_number,"onUpdate:modelValue":e[3]||(e[3]=s=>t.consultant.license_number=s),label:"License Number"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.consultant.specialization,"onUpdate:modelValue":e[4]||(e[4]=s=>t.consultant.specialization=s),label:"Specialization"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.consultant.qualification,"onUpdate:modelValue":e[5]||(e[5]=s=>t.consultant.qualification=s),label:"Qualification"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"8"},{default:l(()=>[a(Q,{class:"text-subtitle-1 mb-1"},{default:l(()=>e[22]||(e[22]=[w("Existing Attachments")])),_:1,__:[22]}),b.value.length?(y(),N("div",Se,[(y(!0),N(R,null,O(b.value,(s,r)=>(y(),q(W,{key:"srv-"+r+s.name,label:"",size:"small",color:"secondary",variant:"tonal",class:"me-2 mb-2",title:s.url||s.name,closable:"","onClick:close":D=>ne(r)},{default:l(()=>[w(E(s.name),1)]),_:2},1032,["title","onClick:close"]))),128))])):(y(),N("div",Pe," No existing attachments. ")),a(Q,{class:"text-subtitle-1 mb-1 mt-2"},{default:l(()=>e[23]||(e[23]=[w("Add New Attachments")])),_:1,__:[23]}),(y(),q(ke,{key:m.value,modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=s=>v.value=s),multiple:"",placeholder:"Upload your documents",label:"File input","prepend-icon":"tabler-paperclip",chips:"","show-size":"",counter:"",accept:".pdf,.jpg,.jpeg,.png,.gif,.doc,.docx,.xls,.xlsx"},{selection:l(({fileNames:s})=>[(y(!0),N(R,null,O(s,(r,D)=>(y(),q(W,{key:"new-"+D+r,label:"",size:"small",color:"primary",class:"me-2 mb-2"},{default:l(()=>[w(E(r),1)]),_:2},1024))),128))]),_:1},8,["modelValue"])),e[24]||(e[24]=f("div",{class:"text-caption mt-1"}," Existing files are shown above (grey). Newly selected files appear in blue. ",-1))]),_:1,__:[24]})]),_:1}),a(h,null,{default:l(()=>[a(i,{cols:"12",class:"mt-4"},{default:l(()=>[a(M,{variant:"flat",class:"section-bar bg-grey-lighten-3"},{default:l(()=>[f("div",Ne,[a(P,{icon:"tabler-map-pin"}),e[25]||(e[25]=f("span",{class:"text-subtitle-1 section-title"},"Address",-1)),e[26]||(e[26]=f("span",{class:"required-star"},"*",-1))])]),_:1})]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.address.city,"onUpdate:modelValue":e[7]||(e[7]=s=>t.address.city=s),label:"City"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.address.district,"onUpdate:modelValue":e[8]||(e[8]=s=>t.address.district=s),label:"District"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.address.street,"onUpdate:modelValue":e[9]||(e[9]=s=>t.address.street=s),label:"Street"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.address.building_number,"onUpdate:modelValue":e[10]||(e[10]=s=>t.address.building_number=s),label:"Building Number"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.address.additional_number,"onUpdate:modelValue":e[11]||(e[11]=s=>t.address.additional_number=s),label:"Additional Number"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.address.postal_code,"onUpdate:modelValue":e[12]||(e[12]=s=>t.address.postal_code=s),label:"Postal Code"},null,8,["modelValue"])]),_:1}),a(i,{md:"6",cols:"12"},{default:l(()=>[a(o,{modelValue:t.address.short_address,"onUpdate:modelValue":e[13]||(e[13]=s=>t.address.short_address=s),label:"Short Address"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",class:"mt-4"},{default:l(()=>[a(M,{variant:"flat",class:"section-bar bg-grey-lighten-3"},{default:l(()=>[f("div",he,[a(P,{icon:"tabler-credit-card"}),e[27]||(e[27]=f("span",{class:"text-subtitle-1 section-title"},"Bank",-1))])]),_:1})]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.bank.account_holder_name,"onUpdate:modelValue":e[14]||(e[14]=s=>t.bank.account_holder_name=s),label:"Account Holder Name"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.bank.account_number,"onUpdate:modelValue":e[15]||(e[15]=s=>t.bank.account_number=s),label:"Account Number / IBAN"},null,8,["modelValue"])]),_:1}),a(i,{md:"4",cols:"12"},{default:l(()=>[a(o,{modelValue:t.bank.bank_name,"onUpdate:modelValue":e[16]||(e[16]=s=>t.bank.bank_name=s),label:"Bank Name"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",class:"d-flex flex-wrap gap-4 mt-4"},{default:l(()=>[a(z,{type:"submit",loading:C.value,color:"primary"},{default:l(()=>[a(P,{icon:"tabler-device-floppy",class:"me-2"}),e[28]||(e[28]=w(" Save changes "))]),_:1,__:[28]},8,["loading"]),a(z,{color:"secondary",variant:"tonal",type:"reset"},{default:l(()=>[a(P,{icon:"tabler-x",class:"me-2"}),e[29]||(e[29]=w(" Cancel "))]),_:1,__:[29]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(S,{"is-dialog-visible":A.value,"onUpdate:isDialogVisible":e[17]||(e[17]=s=>A.value=s),"confirmation-question":"Are you sure you want to deactivate your account?","confirm-title":"Deactivated!","confirm-msg":"Your account has been deactivated successfully.","cancel-title":"Cancelled","cancel-msg":"Account Deactivation Cancelled!"},null,8,["is-dialog-visible"])],64)}}},Qe=ee(Ie,[["__scopeId","data-v-85ac0f5b"]]);export{Qe as A,Je as a};

import{_ as Xe}from"./AppTextField-BlxqpuS8.js";import{bc as et,u as tt,bd as lt,r as C,bb as ge,O as p,E as ot,f as w,e as o,o as c,b as t,d as a,k as _,c as x,s as r,a9 as u,t as d,a2 as h,F as G,h as xe,p as at,aF as oe,l as ae,v as ye}from"./index-BVpKynl4.js";import{u as nt}from"./authStore-CRiwnC_8.js";import{u as st}from"./globalStore-CbVyHARU.js";import{$ as D}from"./api-DA_9kprT.js";import{_ as it}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as rt}from"./VContainer-Bi-Tg67C.js";import{V as T,a as k}from"./VRow-ZTOT4Z3s.js";import{V,b as F,d as K}from"./VCard-CcIsawTw.js";import{V as S}from"./VCardText-ZhV-99WX.js";import{V as y}from"./VChip-B2bouHh-.js";import{V as Y}from"./VSheet-D3ZdBAes.js";import{V as he}from"./VAvatar-QJTJwQfz.js";import{V as B}from"./VSpacer-B4_zHWTl.js";import{V as ut}from"./VTooltip-BE76jK9o.js";import{V as dt}from"./VTable-DIyP_YSt.js";import{V as ct}from"./VAlert-csVW849v.js";import{V as Ce}from"./VForm-BXdIeyJa.js";import{V as mt}from"./VTextField-DPG1ptcm.js";import{V as pt}from"./VDivider-MvBfrnW2.js";import{V as ft}from"./VTextarea-DHa2q1rw.js";import{V as ne}from"./VDialog-D6mGH41k.js";import{V as vt,a as _t}from"./VToolbar-j13VafX4.js";import{V as bt}from"./VImg-B5byWgVS.js";import{V as gt}from"./VSnackbar-CnV7cy9h.js";import"./form-BTaXsSip.js";import"./useApi-C1A9lyWN.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VSlideGroup-DCs3qmnQ.js";import"./VOverlay-DwBuqUsh.js";import"./easing-Bybner-F.js";import"./delay-GoSZAG7F.js";import"./lazy-BKTO8477.js";import"./scopeId-DCEPhMdw.js";import"./forwardRefs-C-GTDzx5.js";/* empty css                   */import"./VCounter-BrEPeYtP.js";import"./VField-hxsHU2Y6.js";import"./VInput-ts4WNp2Q.js";import"./dialog-transition-CsJHPI1x.js";const xt={class:"sidebar-stack"},yt={class:"status-section mb-6"},ht={class:"info-section mb-6"},Ct={class:"info-item d-flex align-center mb-2"},Vt={class:"text-body-2"},wt={class:"info-item d-flex align-center mb-2"},kt={class:"text-body-2"},St={class:"info-item d-flex align-center mb-2"},At={class:"info-item d-flex align-center"},zt={key:0,class:"offer-price-compact mt-4"},Ot={class:"d-flex align-center gap-2"},Nt={class:"text-subtitle-1 font-weight-bold"},Tt={key:1,class:"consultant-section mt-6"},Ft={class:"d-flex align-center"},Pt={class:"avatar-initials"},Rt={class:"min-w-0"},jt={class:"text-body-1 font-weight-600 text-truncate"},Et={class:"text-caption text-medium-emphasis text-truncate"},Ut={class:"contact-method-display"},It={class:"contact-details"},$t={key:0,class:"detail-item d-flex align-center mb-2"},Lt={key:1,class:"detail-item d-flex align-center mb-2"},Mt={key:2,class:"detail-item"},Dt={key:3,class:"detail-item"},Bt={class:"text-h4 font-weight-bold mb-2 primary--text"},qt={class:"d-flex align-center flex-wrap gap-2 mb-3"},Jt={class:"text-body-1 text-medium-emphasis mb-0"},Wt={class:"d-flex flex-wrap gap-2 justify-end"},Zt={key:0,class:"attachments-grid"},Gt={key:0,class:"attachment-preview"},Kt=["src","alt"],Yt={key:1,class:"attachment-preview file-icon-preview"},Ht={class:"text-caption text-medium-emphasis mt-2"},Qt={key:1,class:"text-center py-8"},Xt={class:"d-flex align-center justify-space-between flex-wrap"},el={class:"d-flex align-center"},tl={class:"text-h5 font-weight-bold"},ll={class:"text-right mt-3 mt-md-0"},ol={class:"text-right font-weight-bold"},al={class:"text-medium-emphasis font-weight-600"},nl={class:"text-right font-weight-bold"},sl={class:"text-right"},il={class:"d-flex align-center mt-3 text-caption text-medium-emphasis"},rl={class:"text-body-2 whitespace-pre-wrap"},ul={key:0,class:"contact-selection"},dl={class:"d-flex align-center gap-2"},cl={class:"mx-auto icon-pill"},ml={class:"text-h6 mt-2 fw-600"},pl={class:"details-title d-flex align-center gap-2"},Ve=.15,fl={__name:"[id]",setup(vl){const P=et(),R=tt().params.id,we=st(),ke=`/v1/consultations/${R}`,Se=`/v1/consultations/${R}/offer`,Ae=`/v1/consultations/${R}/accept`,ze=`/v1/consultations/${R}/reject`,Oe=`/v1/consultations/${R}/response`,Ne=nt();console.log(Ne.user.value,"user in the auth store");const Te=lt();console.log(Te.user,"user in the setting store");const se=C(!0),N=C(!1),q=C(!1),J=C(!1),j=C(!1),E=C(!1),Fe=C(""),v=C(!1),b=C(""),g=C("success"),n=ge({id:null,consultation_number:"",subject:"",description:"",attachments:[],status:null,activity:null,type:null,date:null,oppointment_method:null,oppointment_url:null,oppointment_date:null,oppointment_time:null,price:null,notes:null,handledby:null,consultant_response:null}),i=ge({price:"",notes:"",consultant_response:"",oppointment_method:null,oppointment_date:null,oppointment_time:null,oppointment_url:""}),W=p(()=>we.currentLanguage||"en"),H=(l,e)=>{const f=e||W.value;return l==null?"—":typeof l=="string"?l:l[f]??l.en??l.ar??"—"},Pe=l=>{const e=typeof l=="object"?(l==null?void 0:l.en)||(l==null?void 0:l.ar)||"":l||"";return String(e).trim().toLowerCase()},A=l=>{const e=String(l||"").toLowerCase();return e==="chat"?{icon:"tabler-message-circle",color:"info",label:"Chat"}:e==="session"?{icon:"tabler-video",color:"success",label:"Session"}:{icon:"tabler-circle-dashed",color:"secondary",label:"—"}},ie=l=>{const e=String(l||"").toLowerCase();return e.includes("pending")?"warning":e.includes("closed")?"success":e.includes("new")?"info":e.includes("archived")?"secondary":e.includes("draft")?"info":"primary"},re=p(()=>{var l;return H((l=n.status)==null?void 0:l.title)}),ue=p(()=>{var l;return H((l=n.activity)==null?void 0:l.name)}),de=p(()=>{var l;return H((l=n.type)==null?void 0:l.name)}),ce=p(()=>{var l;return Pe((l=n.status)==null?void 0:l.title)}),Q=p(()=>Array.isArray(n.attachments)?n.attachments.length:0),Re=p(()=>n.oppointment_method&&n.oppointment_method!=="none"),je=p(()=>!n.oppointment_method||n.oppointment_method==="none"),Ee=p(()=>{var l;return((l=n.status)==null?void 0:l.id)===2}),U=p(()=>{var l;return((l=n.status)==null?void 0:l.id)===4}),X=p(()=>{var l;return((l=n.status)==null?void 0:l.id)===3}),I=p(()=>{var l;return((l=n.status)==null?void 0:l.id)===5}),me=p(()=>X.value&&P.can("accept","offer")),pe=p(()=>X.value&&P.can("reject","offer"));function ee(l){const e=Number(l);if(Number.isNaN(e))return"";const f=W.value==="ar"?"ar-SA":"en-SA";try{return new Intl.NumberFormat(f,{style:"currency",currency:"SAR",maximumFractionDigits:2}).format(e)}catch{const s=e.toFixed(2);return W.value==="ar"?`${s} ر.س`:`SAR ${s}`}}const z=p(()=>{const l=n.price??i.price;return l===""||l===null||l===void 0?null:Number(l)}),Ue=p(()=>z.value!==null?ee(z.value):null),fe=C([{key:"chat",title:{en:"Instant Chat",ar:"محادثة فورية"},desc:{en:"Instant text chat with the consultant through the platform",ar:"محادثة نصية فورية مع المستشار عبر المنصة"},icon:"tabler-message-circle",className:"soft-chat"},{key:"session",title:{en:"Video Call",ar:"مكالمة فيديو"},desc:{en:"Live video session via Zoom with screen sharing",ar:"جلسة فيديو مباشرة عبر Zoom مع مشاركة الشاشة"},icon:"tabler-video",className:"soft-video"}]);function Ie(l){i.oppointment_method=l,i.oppointment_date=null,i.oppointment_time=null,l!=="session"&&(i.oppointment_url="")}const $e=[l=>!!l||"Price is required",l=>!isNaN(l)&&Number(l)>0||"Please enter a valid price"],$=C(!1),te=C(null);function Le(l){te.value=l,$.value=!0}function Z(l){try{return new URL(l,window.location.origin).pathname.split(".").pop().toLowerCase()||"file"}catch{return"file"}}function ve(l){return["jpg","jpeg","png","gif","bmp","webp","svg"].includes(Z(l))}function Me(l){const e=Z(l),f={pdf:"mdi-file-pdf-box",doc:"mdi-file-word",docx:"mdi-file-word",txt:"mdi-file-document-outline",xls:"mdi-file-excel",xlsx:"mdi-file-excel",csv:"mdi-file-delimited",ppt:"mdi-file-powerpoint",pptx:"mdi-file-powerpoint",zip:"mdi-folder-zip",rar:"mdi-folder-zip","7z":"mdi-folder-zip",mp4:"mdi-file-video",avi:"mdi-file-video",mov:"mdi-file-video",mp3:"mdi-file-music",wav:"mdi-file-music",default:"mdi-file"};return f[e]||f.default}function De(l){const e=Z(l),f={pdf:"red",doc:"blue",docx:"blue",xls:"green",xlsx:"green",ppt:"orange",pptx:"orange",zip:"purple",rar:"purple","7z":"purple",txt:"grey",mp4:"pink",mp3:"purple",default:"grey"};return f[e]||f.default}function Be(l){ve(l)?Le(l):window.open(l,"_blank")}function qe(l){const e=document.createElement("a");e.href=l,e.download=l.split("/").pop(),e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}function Je(l){const e=l.target;e.classList.add("image-error"),e.alt="Failed to load image"}function We(l){const e=String(l).split(" ").filter(Boolean);if(!e.length)return"C";const f=e[0][0]||"",s=e[1]&&e[1][0]||"";return(f+s).toUpperCase()}async function L(){se.value=!0;try{const l=await D(ke,{method:"GET"});Object.assign(n,(l==null?void 0:l.data)||{}),n.price!==null&&n.consultant_response&&(i.consultant_response=n.consultant_response)}catch(l){console.error(l),b.value="Failed to load consultation details.",g.value="error",v.value=!0}finally{se.value=!1}}async function Ze(){var l,e,f,s;if(!i.price||isNaN(i.price)||Number(i.price)<=0){b.value="Please enter a valid price.",g.value="error",v.value=!0;return}if(i.oppointment_method){if(!i.oppointment_date){b.value="Appointment date is required.",g.value="error",v.value=!0;return}if(!i.oppointment_time){b.value="Appointment time is required.",g.value="error",v.value=!0;return}if(i.oppointment_method==="session"&&!((l=i.oppointment_url)!=null&&l.trim())){b.value="Session URL is required for video call sessions.",g.value="error",v.value=!0;return}}N.value=!0;try{const m={price:Number(i.price),notes:((e=i.notes)==null?void 0:e.trim())||null};(f=i.consultant_response)!=null&&f.trim()&&(m.consultant_response=i.consultant_response.trim()),i.oppointment_method&&(m.oppointment_method=i.oppointment_method,m.oppointment_date=i.oppointment_date,m.oppointment_time=i.oppointment_time,i.oppointment_method==="session"&&((s=i.oppointment_url)!=null&&s.trim())&&(m.oppointment_url=i.oppointment_url.trim())),await D(Se,{method:"PUT",body:m}),b.value="Offer submitted successfully!",g.value="success",v.value=!0,await L()}catch(m){console.error(m),b.value=(m==null?void 0:m.message)||"Failed to submit offer.",g.value="error",v.value=!0}finally{N.value=!1}}async function Ge(){var l;if(!((l=i.consultant_response)!=null&&l.trim())){b.value="Please enter consultation response text.",g.value="error",v.value=!0;return}N.value=!0;try{const e={consultant_response:i.consultant_response.trim()};await D(Oe,{method:"PUT",body:e}),b.value="Consultation text updated successfully!",g.value="success",v.value=!0,await L()}catch(e){console.error(e),b.value=(e==null?void 0:e.message)||"Failed to update consultation text.",g.value="error",v.value=!0}finally{N.value=!1}}async function Ke(){q.value=!0;try{await D(Ae,{method:"POST"}),b.value="Offer accepted successfully!",g.value="success",v.value=!0,j.value=!1,await L()}catch(l){console.error(l),b.value=(l==null?void 0:l.message)||"Failed to accept offer.",g.value="error",v.value=!0}finally{q.value=!1}}async function Ye(){J.value=!0;try{await D(ze,{method:"POST"}),b.value="Offer rejected.",g.value="success",v.value=!0,E.value=!1,Fe.value="",await L()}catch(l){console.error(l),b.value=(l==null?void 0:l.message)||"Failed to reject offer.",g.value="error",v.value=!0}finally{J.value=!1}}const _e=p(()=>z.value?z.value*Ve:0),He=p(()=>z.value?z.value+_e.value:0),Qe=p(()=>ee(_e.value)),M=p(()=>ee(He.value));return ot(L),(l,e)=>{const f=Xe;return c(),w(rt,{fluid:"",class:"consultation-container"},{default:o(()=>[t(T,null,{default:o(()=>[t(k,{cols:"12",md:"3",class:"sidebar"},{default:o(()=>[a("div",xt,[t(V,{class:"sidebar-card",elevation:"2",rounded:"lg"},{default:o(()=>[t(S,{class:"pa-4"},{default:o(()=>[a("div",yt,[e[16]||(e[16]=a("div",{class:"text-caption text-medium-emphasis mb-2"}," CONSULTATION STATUS ",-1)),t(y,{color:ie(ce.value),size:"small",label:"",class:"text-capitalize"},{default:o(()=>[t(u,{icon:"tabler-flag-3",class:"me-1"}),r(" "+d(re.value),1)]),_:1},8,["color"])]),a("div",ht,[e[17]||(e[17]=a("div",{class:"text-caption text-medium-emphasis mb-2"}," CONSULTATION INFO ",-1)),a("div",Ct,[t(u,{icon:"tabler-hash",size:"18",class:"me-2 text-medium-emphasis"}),a("span",Vt,d(n.consultation_number||"—"),1)]),a("div",wt,[t(u,{icon:"tabler-calendar",size:"18",class:"me-2 text-medium-emphasis"}),a("span",kt,d(n.date||"—"),1)]),a("div",St,[t(y,{size:"x-small",variant:"tonal",color:"primary",label:""},{default:o(()=>[t(u,{icon:"tabler-briefcase",class:"me-1"}),r(" "+d(ue.value),1)]),_:1})]),a("div",At,[t(y,{size:"x-small",variant:"tonal",color:"secondary",label:""},{default:o(()=>[t(u,{icon:"tabler-tag",class:"me-1"}),r(" "+d(de.value),1)]),_:1})])]),z.value!==null?(c(),x("div",zt,[e[18]||(e[18]=a("div",{class:"text-caption text-medium-emphasis mb-2"}," OFFER PRICE ",-1)),t(Y,{class:"d-flex align-center justify-space-between pa-3 rounded-lg price-chip",border:""},{default:o(()=>[a("div",Ot,[t(u,{icon:"mdi-currency-usd",color:"primary"}),a("span",Nt,d(M.value),1)]),t(y,{size:"x-small",color:U.value?"success":"primary",variant:"tonal"},{default:o(()=>[r(d(U.value?"Accepted":"Proposed"),1)]),_:1},8,["color"])]),_:1})])):_("",!0),n.handledby!=null?(c(),x("div",Tt,[e[19]||(e[19]=a("div",{class:"text-caption text-medium-emphasis mb-2"}," CONSULTANT ",-1)),t(Y,{class:"pa-3 rounded-lg",border:""},{default:o(()=>{var s,m,O;return[a("div",Ft,[t(he,{size:"44",color:"primary",variant:"tonal",class:"me-3"},{default:o(()=>{var le,be;return[a("span",Pt,d(We(((le=n.handledby)==null?void 0:le.name)||((be=n.handledby)==null?void 0:be.username)||"C")),1)]}),_:1}),a("div",Rt,[a("div",jt,d(((s=n.handledby)==null?void 0:s.name)||"—"),1),a("div",Et,d(((m=n.handledby)==null?void 0:m.email)||((O=n.handledby)==null?void 0:O.username)||"—"),1)])])]}),_:1})])):_("",!0)]),_:1})]),_:1}),Re.value?(c(),w(V,{key:0,class:"contact-card",elevation:"2",rounded:"lg"},{default:o(()=>[t(F,{class:"d-flex align-center"},{default:o(()=>[t(u,{icon:A(n.oppointment_method).icon,class:"me-2",color:A(n.oppointment_method).color},null,8,["icon","color"]),e[20]||(e[20]=a("span",{class:"text-h6"},"Contact Method",-1))]),_:1,__:[20]}),t(S,null,{default:o(()=>[a("div",Ut,[t(y,{color:A(n.oppointment_method).color,size:"small",label:"",class:"text-capitalize mb-3"},{default:o(()=>[t(u,{icon:A(n.oppointment_method).icon,class:"me-1"},null,8,["icon"]),r(" "+d(A(n.oppointment_method).label),1)]),_:1},8,["color"]),a("div",It,[n.oppointment_date?(c(),x("div",$t,[t(y,{size:"x-small",variant:"tonal",color:"primary"},{default:o(()=>[t(u,{icon:"tabler-calendar",class:"me-1"}),r(" "+d(n.oppointment_date),1)]),_:1})])):_("",!0),n.oppointment_time?(c(),x("div",Lt,[t(y,{size:"x-small",variant:"tonal",color:"primary"},{default:o(()=>[t(u,{icon:"tabler-clock",class:"me-1"}),r(" "+d(n.oppointment_time),1)]),_:1})])):_("",!0),n.oppointment_method==="session"&&n.oppointment_url&&I.value?(c(),x("div",Mt,[t(h,{color:"success",variant:"flat",block:"",size:"small",href:n.oppointment_url},{default:o(()=>[t(u,{icon:"tabler-external-link",class:"me-2"}),e[21]||(e[21]=r(" Join Session "))]),_:1,__:[21]},8,["href"])])):n.oppointment_method==="chat"&&I.value?(c(),x("div",Dt,[t(h,{color:"success",variant:"flat",block:"",size:"small",to:{name:"apps-consultations-chat-id",params:{id:n.id}}},{default:o(()=>[t(u,{icon:"tabler-external-link",class:"me-2"}),e[22]||(e[22]=r(" Join Chat "))]),_:1,__:[22]},8,["to"])])):_("",!0)])])]),_:1})]),_:1})):_("",!0)])]),_:1}),t(k,{cols:"12",md:"9"},{default:o(()=>[t(V,{class:"header-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[t(S,{class:"pa-6"},{default:o(()=>[t(T,{align:"center",class:"gy-2"},{default:o(()=>[t(k,{cols:"12",md:"8"},{default:o(()=>[a("h1",Bt,d(n.subject||"—"),1),a("div",qt,[t(y,{variant:"outlined",size:"small",color:"primary",label:""},{default:o(()=>[t(u,{icon:"tabler-briefcase",class:"me-1"}),r(" "+d(ue.value),1)]),_:1}),t(y,{variant:"outlined",size:"small",color:"secondary",label:""},{default:o(()=>[t(u,{icon:"tabler-tag",class:"me-1"}),r(" "+d(de.value),1)]),_:1}),t(y,{size:"small",label:"",color:A(n.oppointment_method).label==="—"?"secondary":A(n.oppointment_method).color,class:"text-capitalize"},{default:o(()=>[t(u,{icon:A(n.oppointment_method).icon,class:"me-1"},null,8,["icon"]),r(" "+d(A(n.oppointment_method).label),1)]),_:1},8,["color"]),t(y,{color:ie(ce.value),size:"small",label:"",class:"text-capitalize"},{default:o(()=>[t(u,{icon:"tabler-flag-3",class:"me-1"}),r(" "+d(re.value),1)]),_:1},8,["color"])]),a("p",Jt,d(n.description||"—"),1)]),_:1}),me.value||pe.value?(c(),w(k,{key:0,cols:"12",md:"4",class:"text-md-end"},{default:o(()=>[a("div",Wt,[me.value?(c(),w(h,{key:0,color:"success",size:"large",variant:"flat",loading:q.value,onClick:e[0]||(e[0]=s=>j.value=!0)},{default:o(()=>[t(u,{icon:"mdi-check-circle-outline",class:"me-2"}),e[23]||(e[23]=r(" Accept Offer "))]),_:1,__:[23]},8,["loading"])):_("",!0),pe.value?(c(),w(h,{key:1,color:"error",size:"large",variant:"tonal",loading:J.value,onClick:e[1]||(e[1]=s=>E.value=!0)},{default:o(()=>[t(u,{icon:"mdi-close-circle-outline",class:"me-2"}),e[24]||(e[24]=r(" Reject Offer "))]),_:1,__:[24]},8,["loading"])):_("",!0)]),e[25]||(e[25]=a("div",{class:"text-caption text-medium-emphasis mt-2"}," Please respond to the offer to proceed. ",-1))]),_:1,__:[25]})):_("",!0)]),_:1})]),_:1})]),_:1}),t(T,null,{default:o(()=>[t(k,{cols:"12",md:"6"},{default:o(()=>[t(V,{class:"attachments-card",elevation:"2",rounded:"lg"},{default:o(()=>[t(F,{class:"d-flex align-center"},{default:o(()=>[t(y,{size:"small",class:"ms-2 me-2",color:"primary",label:""},{default:o(()=>[t(u,{icon:"tabler-folder"})]),_:1}),e[26]||(e[26]=a("span",{class:"text-h6"},"Attachments",-1)),t(y,{size:"small",class:"ms-2",color:Q.value>0?"primary":"secondary",label:""},{default:o(()=>[r(d(Q.value),1)]),_:1},8,["color"])]),_:1,__:[26]}),t(S,null,{default:o(()=>[Q.value>0?(c(),x("div",Zt,[(c(!0),x(G,null,xe(n.attachments,(s,m)=>(c(),w(V,{key:m,class:"attachment-item",variant:"outlined",onClick:O=>Be(s)},{default:o(()=>[ve(s)?(c(),x("div",Gt,[a("img",{src:s,alt:`Attachment ${m+1}`,class:"attachment-image",onError:e[2]||(e[2]=O=>Je(O))},null,40,Kt)])):(c(),x("div",Yt,[t(u,{icon:Me(s),color:De(s),size:"64"},null,8,["icon","color"]),a("div",Ht,d(Z(s).toUpperCase()),1)])),t(K,{class:"pa-2 attachment-actions"},{default:o(()=>[t(B),t(ut,{text:"preview",location:"top"},{activator:o(({props:O})=>[t(h,at({ref_for:!0},O,{size:"small",variant:"tonal",color:"primary",onClick:oe(le=>qe(s),["stop"]),class:"action-btn"}),{prepend:o(()=>[t(u,{icon:"tabler-external-link"})]),_:2},1040,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))])):(c(),x("div",Qt,[t(u,{icon:"mdi-folder-open-outline",size:"64",class:"text-medium-emphasis mb-2"}),e[27]||(e[27]=a("div",{class:"text-body-1 text-medium-emphasis"}," No attachments available ",-1))]))]),_:1})]),_:1})]),_:1}),t(k,{cols:"12",md:"6"},{default:o(()=>[z.value!==null?(c(),w(V,{key:0,class:"offer-price-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[t(S,{class:"pa-5"},{default:o(()=>[a("div",Xt,[a("div",el,[t(he,{color:"primary",variant:"tonal",size:"44",class:"mr-3"},{default:o(()=>[t(u,{icon:"mdi-currency-usd"})]),_:1}),a("div",null,[e[28]||(e[28]=a("div",{class:"text-caption text-medium-emphasis mb-1"}," Current Offer ",-1)),a("div",tl,d(M.value),1)])]),a("div",ll,[t(y,{color:U.value||I.value?"success":"primary",variant:"tonal",class:"font-weight-600"},{default:o(()=>[r(d(U.value?"Waiting for payment":I.value?"Paid":X.value?"Waiting for client approval":""),1)]),_:1},8,["color"])])]),t(Y,{class:"mt-4 pa-4",color:"blue-lighten-5",rounded:"lg",elevation:"0"},{default:o(()=>[e[32]||(e[32]=a("div",{class:"text-subtitle-1 font-weight-bold mb-3"}," Offer Details ",-1)),t(dt,{class:"elevation-0 rounded-lg offer-table"},{default:o(()=>[a("tbody",null,[a("tr",null,[e[29]||(e[29]=a("td",{class:"text-medium-emphasis font-weight-600"}," Offer Price (before tax) ",-1)),a("td",ol,d(Ue.value),1)]),a("tr",null,[a("td",al," Tax ("+d(Ve*100)+"%) ",1),a("td",nl,d(Qe.value),1)]),a("tr",null,[e[30]||(e[30]=a("td",{class:"text-medium-emphasis font-weight-600"}," Total Amount to Pay ",-1)),a("td",sl,[t(y,{color:"primary",variant:"flat",class:"px-4 py-2 font-weight-bold"},{default:o(()=>[r(d(M.value),1)]),_:1})])])])]),_:1}),a("div",il,[t(u,{icon:"mdi-information-outline",size:"16",class:"mr-1"}),e[31]||(e[31]=a("span",null," The total amount includes the offer price plus tax. ",-1))])]),_:1,__:[32]}),t(ct,{type:"info",variant:"tonal",class:"mt-4",density:"comfortable"},{default:o(()=>[e[33]||(e[33]=a("div",{class:"text-caption text-medium-emphasis mb-1"}," Consultant Response ",-1)),a("div",rl,[I.value&&n.consultant_response!=null?(c(),x(G,{key:0},[r(d(n.consultant_response),1)],64)):ae(P).can("accept","offer")?(c(),x(G,{key:1},[r(" Consultant response will appear here once it is ready. ")],64)):_("",!0)])]),_:1,__:[33]})]),_:1})]),_:1})):_("",!0),ae(P).can("write","offer")&&Ee.value?(c(),w(V,{key:1,class:"offer-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[t(F,{class:"d-flex align-center"},{default:o(()=>[t(u,{icon:"mdi-currency-usd",class:"me-2",color:"primary"}),e[34]||(e[34]=a("span",{class:"text-h6"},"Make an Offer",-1))]),_:1,__:[34]}),t(S,null,{default:o(()=>[t(Ce,{onSubmit:oe(Ze,["prevent"])},{default:o(()=>[t(mt,{modelValue:i.price,"onUpdate:modelValue":e[3]||(e[3]=s=>i.price=s),label:"Consultation Price",type:"text",prefix:"SAR",required:"",rules:$e,class:"mb-4"},null,8,["modelValue"]),je.value?(c(),x("div",ul,[t(T,null,{default:o(()=>[t(k,{cols:"12"},{default:o(()=>[t(Y,{variant:"flat",class:"section-bar bg-grey-lighten-3"},{default:o(()=>[a("div",dl,[t(u,{icon:"tabler-messages"}),e[35]||(e[35]=a("span",{class:"text-subtitle-1 section-title"},"Contact Methods (Optional)",-1))])]),_:1})]),_:1}),(c(!0),x(G,null,xe(fe.value,s=>(c(),w(k,{cols:"12",md:"6",key:s.key},{default:o(()=>[t(V,{class:ye(["method-card soft-card",[s.className,{"is-selected":i.oppointment_method===s.key}]]),variant:"outlined",onClick:m=>Ie(s.key)},{default:o(()=>[t(S,{class:"text-center"},{default:o(()=>[a("div",cl,[t(u,{icon:s.icon,size:"32"},null,8,["icon"])]),a("div",ml,d(s.title[W.value]),1)]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1}),i.oppointment_method?(c(),w(T,{key:0},{default:o(()=>[t(k,{cols:"12"},{default:o(()=>{var s;return[t(V,{class:ye(["details-card",(s=fe.value.find(m=>m.key===i.oppointment_method))==null?void 0:s.className]),variant:"outlined"},{default:o(()=>[t(S,null,{default:o(()=>[a("div",pl,[t(u,{icon:i.oppointment_method==="session"?"tabler-video":"tabler-message-circle"},null,8,["icon"]),a("span",null,d(i.oppointment_method==="session"?"Video Call":"Instant Chat"),1)]),t(pt,{class:"my-4"}),t(T,null,{default:o(()=>[t(k,{cols:"12",md:"6"},{default:o(()=>[t(f,{modelValue:i.oppointment_date,"onUpdate:modelValue":e[4]||(e[4]=m=>i.oppointment_date=m),type:"date",label:"Appointment Date *","prepend-inner-icon":"tabler-calendar"},null,8,["modelValue"])]),_:1}),t(k,{cols:"12",md:"6"},{default:o(()=>[t(f,{modelValue:i.oppointment_time,"onUpdate:modelValue":e[5]||(e[5]=m=>i.oppointment_time=m),type:"time",label:"Time *","prepend-inner-icon":"tabler-clock"},null,8,["modelValue"])]),_:1}),i.oppointment_method==="session"?(c(),w(k,{key:0,cols:"12"},{default:o(()=>[t(f,{modelValue:i.oppointment_url,"onUpdate:modelValue":e[6]||(e[6]=m=>i.oppointment_url=m),label:"Session URL *",placeholder:"Zoom link","prepend-inner-icon":"tabler-link"},null,8,["modelValue"])]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1},8,["class"])]}),_:1})]),_:1})):_("",!0)])):_("",!0),t(h,{color:"primary",size:"large",type:"submit",loading:N.value,block:"",class:"mt-5"},{default:o(()=>[t(u,{icon:"mdi-send",class:"me-2"}),e[36]||(e[36]=r(" Send Offer "))]),_:1,__:[36]},8,["loading"])]),_:1})]),_:1})]),_:1})):_("",!0),ae(P).can("answer","consultation")&&U.value?(c(),w(V,{key:2,class:"consultation-text-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[t(F,{class:"d-flex align-center"},{default:o(()=>[t(u,{icon:"mdi-message-text",class:"me-2",color:"primary"}),e[37]||(e[37]=a("span",{class:"text-h6"},"Consultant Consultation",-1))]),_:1,__:[37]}),t(S,null,{default:o(()=>[t(Ce,{onSubmit:oe(Ge,["prevent"])},{default:o(()=>[t(ft,{modelValue:i.consultant_response,"onUpdate:modelValue":e[7]||(e[7]=s=>i.consultant_response=s),label:"Consultant Response to Client",rows:"5",class:"mb-4","auto-grow":"",placeholder:"Enter your consultation response to the client..."},null,8,["modelValue"]),t(h,{color:"primary",size:"large",type:"submit",loading:N.value,block:""},{default:o(()=>[t(u,{icon:"mdi-content-save",class:"me-2"}),e[38]||(e[38]=r(" Send Consultation Response "))]),_:1,__:[38]},8,["loading"])]),_:1})]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(ne,{modelValue:$.value,"onUpdate:modelValue":e[10]||(e[10]=s=>$.value=s),"max-width":"800"},{default:o(()=>[t(V,null,{default:o(()=>[t(vt,{color:"primary",density:"compact"},{default:o(()=>[t(_t,null,{default:o(()=>e[39]||(e[39]=[r("Image Preview")])),_:1,__:[39]}),t(B),t(h,{icon:"",onClick:e[8]||(e[8]=s=>$.value=!1)},{default:o(()=>[t(u,null,{default:o(()=>e[40]||(e[40]=[r("mdi-close")])),_:1,__:[40]})]),_:1})]),_:1}),t(bt,{src:te.value,"max-height":"600",contain:""},null,8,["src"]),t(K,null,{default:o(()=>[t(B),t(h,{color:"primary",href:te.value,target:"_blank",download:""},{default:o(()=>[t(u,{icon:"mdi-download",class:"me-2"}),e[41]||(e[41]=r(" Download "))]),_:1,__:[41]},8,["href"]),t(h,{onClick:e[9]||(e[9]=s=>$.value=!1)},{default:o(()=>e[42]||(e[42]=[r("Close")])),_:1,__:[42]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ne,{modelValue:j.value,"onUpdate:modelValue":e[12]||(e[12]=s=>j.value=s),"max-width":"480"},{default:o(()=>[t(V,null,{default:o(()=>[t(F,{class:"d-flex align-center"},{default:o(()=>[t(u,{icon:"mdi-check-circle-outline",class:"me-2",color:"success"}),e[43]||(e[43]=r(" Confirm Accept Offer "))]),_:1,__:[43]}),t(S,null,{default:o(()=>[e[44]||(e[44]=r(" You are about to accept this offer for ")),a("strong",null,d(M.value),1),e[45]||(e[45]=r(". Continue? "))]),_:1,__:[44,45]}),t(K,null,{default:o(()=>[t(B),t(h,{variant:"text",onClick:e[11]||(e[11]=s=>j.value=!1)},{default:o(()=>e[46]||(e[46]=[r("Cancel")])),_:1,__:[46]}),t(h,{color:"success",loading:q.value,onClick:Ke},{default:o(()=>[t(u,{icon:"mdi-check",class:"me-2"}),e[47]||(e[47]=r(" Accept "))]),_:1,__:[47]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ne,{modelValue:E.value,"onUpdate:modelValue":e[14]||(e[14]=s=>E.value=s),"max-width":"520"},{default:o(()=>[t(V,null,{default:o(()=>[t(F,{class:"d-flex align-center"},{default:o(()=>[t(u,{icon:"mdi-close-circle-outline",class:"me-2",color:"error"}),e[48]||(e[48]=r(" Confirm Reject Offer "))]),_:1,__:[48]}),t(S,null,{default:o(()=>[e[49]||(e[49]=r(" You are about to reject this offer with ")),a("strong",null,d(M.value),1),e[50]||(e[50]=r(". Continue? "))]),_:1,__:[49,50]}),t(K,null,{default:o(()=>[t(B),t(h,{variant:"text",onClick:e[13]||(e[13]=s=>E.value=!1)},{default:o(()=>e[51]||(e[51]=[r("Cancel")])),_:1,__:[51]}),t(h,{color:"error",loading:J.value,onClick:Ye},{default:o(()=>[t(u,{icon:"mdi-close",class:"me-2"}),e[52]||(e[52]=r(" Reject "))]),_:1,__:[52]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(gt,{modelValue:v.value,"onUpdate:modelValue":e[15]||(e[15]=s=>v.value=s),color:g.value,timeout:"3000"},{default:o(()=>[r(d(b.value),1)]),_:1},8,["modelValue","color"])]),_:1})}}},ao=it(fl,[["__scopeId","data-v-729c978b"]]);export{ao as default};

import{_ as Xe}from"./AppTextField-B_Hg2V0D.js";import{al as Ye,aL as et,u as tt,bd as ot,r as V,bc as ge,O as v,E as at,f as z,e as o,o as p,b as e,d as n,k as b,c as w,t as l,l as i,s as m,a9 as d,a2 as k,F as W,h as xe,p as st,aF as le,v as we}from"./index-C7qtdPxF.js";import{u as lt}from"./authStore-C6H5sLnu.js";import{u as nt}from"./globalStore-D98SJR2D.js";import{$ as q}from"./api-CdP6DVdi.js";import{_ as it}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ct}from"./VContainer-BaHIFDT3.js";import{V as F,a as T}from"./VRow-B7mc-M76.js";import{V as C,b as j,d as Q}from"./VCard-CvoYH-tB.js";import{V as S}from"./VCardText--YnIOn_v.js";import{V as y}from"./VChip-0oIqGjbL.js";import{V as X}from"./VSheet-DN0xJD9A.js";import{V as ye}from"./VAvatar-G0k920wU.js";import{V as G}from"./VSpacer-BDvFYnO8.js";import{V as rt}from"./VTooltip-VvyISUhb.js";import{V as ut}from"./VTable-B4rWIEzF.js";import{V as dt}from"./VAlert-DSBjtW3E.js";import{V as ke}from"./VForm-BtIWxjHn.js";import{V as mt}from"./VTextField-BsIs5QE9.js";import{V as pt}from"./VDivider-_zTHJTS9.js";import{V as ft}from"./VTextarea-DP6bftxq.js";import{V as ne}from"./VDialog-DJVPmYlj.js";import{V as vt,a as _t}from"./VToolbar-DC6uBGuH.js";import{V as ht}from"./VImg-CqiRrtog.js";import{V as bt}from"./VSnackbar-B-K0RDQC.js";import"./VLabel-BL0IdVQU.js";import"./useApi-Dcbdi9nb.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VSlideGroup-D5YnXd4F.js";import"./VOverlay-CWnbyjJr.js";import"./easing-Bybner-F.js";import"./delay-DqFvUsxw.js";import"./lazy-CS65LDuN.js";import"./scopeId-CskrSFPb.js";import"./forwardRefs-C-GTDzx5.js";import"./form-ZFmfzYYs.js";/* empty css                   */import"./VCounter-Cj1o1Vys.js";import"./VField-BqJwITnM.js";import"./VInput-CbX7aBHh.js";import"./dialog-transition-Bjxq3jQa.js";const gt={class:"sidebar-stack"},xt={class:"status-section mb-6"},wt={class:"text-caption text-medium-emphasis mb-2"},yt={class:"info-section mb-6"},kt={class:"text-caption text-medium-emphasis mb-2"},Vt={class:"info-item d-flex align-center mb-2"},Ct={class:"text-body-2"},zt={class:"info-item d-flex align-center mb-2"},Tt={class:"text-body-2"},St={class:"info-item d-flex align-center mb-2"},Ot={class:"info-item d-flex align-center"},At={key:0,class:"offer-price-compact mt-4"},Nt={class:"text-caption text-medium-emphasis mb-2"},Rt={class:"d-flex align-center gap-2"},Ft={class:"text-subtitle-1 font-weight-bold"},jt={key:1,class:"consultant-section mt-6"},Pt={class:"text-caption text-medium-emphasis mb-2"},Ut={class:"d-flex align-center"},Et={class:"avatar-initials"},$t={class:"min-w-0"},It={class:"text-body-1 font-weight-600 text-truncate"},Lt={class:"text-caption text-medium-emphasis text-truncate"},Dt={class:"text-h6"},Mt={class:"contact-method-display"},Bt={class:"contact-details"},qt={key:0,class:"detail-item d-flex align-center mb-2"},Gt={key:1,class:"detail-item d-flex align-center mb-2"},Ht={key:2,class:"detail-item"},Kt={key:3,class:"detail-item"},Zt={class:"text-h4 font-weight-bold mb-2 primary--text"},Jt={class:"d-flex align-center flex-wrap gap-2 mb-3"},Wt={class:"text-body-1 text-medium-emphasis mb-0"},Qt={class:"d-flex flex-wrap gap-2 justify-end"},Xt={class:"text-caption text-medium-emphasis mt-2"},Yt={class:"text-h6"},eo={key:0,class:"attachments-grid"},to={key:0,class:"attachment-preview"},oo=["src","alt"],ao={key:1,class:"attachment-preview file-icon-preview"},so={class:"text-caption text-medium-emphasis mt-2"},lo={key:1,class:"text-center py-8"},no={class:"text-body-1 text-medium-emphasis"},io={class:"d-flex align-center justify-space-between flex-wrap"},co={class:"d-flex align-center"},ro={class:"text-caption text-medium-emphasis mb-1"},uo={class:"text-h5 font-weight-bold"},mo={class:"text-right mt-3 mt-md-0"},po={class:"text-subtitle-1 font-weight-bold mb-3"},fo={class:"text-medium-emphasis font-weight-600"},vo={class:"text-right font-weight-bold"},_o={class:"text-medium-emphasis font-weight-600"},ho={class:"text-right font-weight-bold"},bo={class:"text-medium-emphasis font-weight-600"},go={class:"text-right"},xo={class:"d-flex align-center mt-3 text-caption text-medium-emphasis"},wo={class:"text-caption text-medium-emphasis mb-1"},yo={class:"text-body-2 whitespace-pre-wrap"},ko={class:"text-h6"},Vo={key:0,class:"contact-selection"},Co={class:"d-flex align-center gap-2"},zo={class:"text-subtitle-1 section-title"},To={class:"mx-auto icon-pill"},So={class:"text-h6 mt-2 fw-600"},Oo={class:"details-title d-flex align-center gap-2"},Ao={class:"text-h6"},Ve=.15,No={__name:"[id]",setup(Ro){const{t:s}=Ye(),P=et(),U=tt().params.id,Ce=nt(),ze=`/v1/consultations/${U}`,Te=`/v1/consultations/${U}/offer`,Se=`/v1/consultations/${U}/accept`,Oe=`/v1/consultations/${U}/reject`,Ae=`/v1/consultations/${U}/response`;lt(),ot();const ie=V(!0),R=V(!1),H=V(!1),K=V(!1),E=V(!1),$=V(!1),Ne=V(""),h=V(!1),g=V(""),x=V("success"),c=ge({id:null,consultation_number:"",subject:"",description:"",attachments:[],status:null,activity:null,type:null,date:null,oppointment_method:null,oppointment_url:null,oppointment_date:null,oppointment_time:null,price:null,notes:null,handledby:null,consultant_response:null}),u=ge({price:"",notes:"",consultant_response:"",oppointment_method:null,oppointment_date:null,oppointment_time:null,oppointment_url:""}),Z=v(()=>Ce.currentLanguage||"en"),Y=(t,a)=>{const _=a||Z.value;return t==null?s("common.na"):typeof t=="string"?t:t[_]??t.en??t.ar??s("common.na")},Re=t=>{const a=typeof t=="object"?(t==null?void 0:t.en)||(t==null?void 0:t.ar)||"":t||"";return String(a).trim().toLowerCase()},O=t=>{const a=String(t||"").toLowerCase();return a==="chat"?{icon:"tabler-message-circle",color:"info",label:s("consultations.view.methods.chat")}:a==="session"?{icon:"tabler-video",color:"success",label:s("consultations.view.methods.session")}:{icon:"tabler-circle-dashed",color:"secondary",label:s("common.na")}},ce=t=>{const a=String(t||"").toLowerCase();return a.includes("pending")?"warning":a.includes("closed")?"success":a.includes("new")?"info":a.includes("archived")?"secondary":a.includes("draft")?"info":"primary"},re=v(()=>{var t;return Y((t=c.status)==null?void 0:t.title)}),ue=v(()=>{var t;return Y((t=c.activity)==null?void 0:t.name)}),de=v(()=>{var t;return Y((t=c.type)==null?void 0:t.name)}),me=v(()=>{var t;return Re((t=c.status)==null?void 0:t.title)}),ee=v(()=>Array.isArray(c.attachments)?c.attachments.length:0),Fe=v(()=>c.oppointment_method&&c.oppointment_method!=="none"),je=v(()=>!c.oppointment_method||c.oppointment_method==="none"),Pe=v(()=>{var t;return((t=c.status)==null?void 0:t.id)===2}),I=v(()=>{var t;return((t=c.status)==null?void 0:t.id)===4}),te=v(()=>{var t;return((t=c.status)==null?void 0:t.id)===3}),L=v(()=>{var t;return((t=c.status)==null?void 0:t.id)===5}),pe=v(()=>te.value&&P.can("accept","offer")),fe=v(()=>te.value&&P.can("reject","offer"));function oe(t){const a=Number(t);if(Number.isNaN(a))return"";const _=Z.value==="ar"?"ar-SA":"en-SA";try{return new Intl.NumberFormat(_,{style:"currency",currency:"SAR",maximumFractionDigits:2}).format(a)}catch{const r=a.toFixed(2);return Z.value==="ar"?`${r} ر.س`:`SAR ${r}`}}const A=v(()=>{const t=c.price??u.price;return t===""||t===null||t===void 0?null:Number(t)}),Ue=v(()=>A.value!==null?oe(A.value):null),ve=V([{key:"chat",title:{en:"Instant Chat",ar:"محادثة فورية"},desc:{en:"Instant text chat with the consultant through the platform",ar:"محادثة نصية فورية مع المستشار عبر المنصة"},icon:"tabler-message-circle",className:"soft-chat"},{key:"session",title:{en:"Video Call",ar:"مكالمة فيديو"},desc:{en:"Live video session via Zoom with screen sharing",ar:"جلسة فيديو مباشرة عبر Zoom مع مشاركة الشاشة"},icon:"tabler-video",className:"soft-video"}]);function Ee(t){u.oppointment_method=t,u.oppointment_date=null,u.oppointment_time=null,t!=="session"&&(u.oppointment_url="")}const $e=[t=>!!t||s("consultations.view.validation.priceRequired"),t=>!isNaN(t)&&Number(t)>0||s("consultations.view.validation.priceValid")],D=V(!1),ae=V(null);function Ie(t){ae.value=t,D.value=!0}function J(t){try{return new URL(t,window.location.origin).pathname.split(".").pop().toLowerCase()||"file"}catch{return"file"}}function _e(t){return["jpg","jpeg","png","gif","bmp","webp","svg"].includes(J(t))}function Le(t){const a=J(t),_={pdf:"mdi-file-pdf-box",doc:"mdi-file-word",docx:"mdi-file-word",txt:"mdi-file-document-outline",xls:"mdi-file-excel",xlsx:"mdi-file-excel",csv:"mdi-file-delimited",ppt:"mdi-file-powerpoint",pptx:"mdi-file-powerpoint",zip:"mdi-folder-zip",rar:"mdi-folder-zip","7z":"mdi-folder-zip",mp4:"mdi-file-video",avi:"mdi-file-video",mov:"mdi-file-video",mp3:"mdi-file-music",wav:"mdi-file-music",default:"mdi-file"};return _[a]||_.default}function De(t){const a=J(t),_={pdf:"red",doc:"blue",docx:"blue",xls:"green",xlsx:"green",ppt:"orange",pptx:"orange",zip:"purple",rar:"purple","7z":"purple",txt:"grey",mp4:"pink",mp3:"purple",default:"grey"};return _[a]||_.default}function Me(t){_e(t)?Ie(t):window.open(t,"_blank")}function Be(t){const a=document.createElement("a");a.href=t,a.download=t.split("/").pop(),a.target="_blank",document.body.appendChild(a),a.click(),document.body.removeChild(a)}function qe(t){const a=t.target;a.classList.add("image-error"),a.alt=s("consultations.view.attachments.imageLoadFailed")}function Ge(t){const a=String(t).split(" ").filter(Boolean);if(!a.length)return"C";const _=a[0][0]||"",r=a[1]&&a[1][0]||"";return(_+r).toUpperCase()}async function M(){ie.value=!0;try{const t=await q(ze,{method:"GET"});Object.assign(c,(t==null?void 0:t.data)||{}),c.price!==null&&c.consultant_response&&(u.consultant_response=c.consultant_response)}catch(t){console.error(t),g.value=s("consultations.view.messages.loadFailed"),x.value="error",h.value=!0}finally{ie.value=!1}}async function He(){var t,a,_,r;if(!u.price||isNaN(u.price)||Number(u.price)<=0){g.value=s("consultations.view.messages.enterValidPrice"),x.value="error",h.value=!0;return}if(u.oppointment_method){if(!u.oppointment_date){g.value=s("consultations.view.messages.appointmentDateRequired"),x.value="error",h.value=!0;return}if(!u.oppointment_time){g.value=s("consultations.view.messages.appointmentTimeRequired"),x.value="error",h.value=!0;return}if(u.oppointment_method==="session"&&!((t=u.oppointment_url)!=null&&t.trim())){g.value=s("consultations.view.messages.sessionUrlRequired"),x.value="error",h.value=!0;return}}R.value=!0;try{const f={price:Number(u.price),notes:((a=u.notes)==null?void 0:a.trim())||null};(_=u.consultant_response)!=null&&_.trim()&&(f.consultant_response=u.consultant_response.trim()),u.oppointment_method&&(f.oppointment_method=u.oppointment_method,f.oppointment_date=u.oppointment_date,f.oppointment_time=u.oppointment_time,u.oppointment_method==="session"&&((r=u.oppointment_url)!=null&&r.trim())&&(f.oppointment_url=u.oppointment_url.trim())),await q(Te,{method:"PUT",body:f}),g.value=s("consultations.view.messages.offerSubmitted"),x.value="success",h.value=!0,await M()}catch(f){console.error(f),g.value=(f==null?void 0:f.message)||s("consultations.view.messages.offerSubmitFailed"),x.value="error",h.value=!0}finally{R.value=!1}}async function Ke(){var t;if(!((t=u.consultant_response)!=null&&t.trim())){g.value=s("consultations.view.messages.enterConsultationResponse"),x.value="error",h.value=!0;return}R.value=!0;try{const a={consultant_response:u.consultant_response.trim()};await q(Ae,{method:"PUT",body:a}),g.value=s("consultations.view.messages.responseUpdated"),x.value="success",h.value=!0,await M()}catch(a){console.error(a),g.value=(a==null?void 0:a.message)||s("consultations.view.messages.responseUpdateFailed"),x.value="error",h.value=!0}finally{R.value=!1}}async function Ze(){H.value=!0;try{await q(Se,{method:"POST"}),g.value=s("consultations.view.messages.offerAccepted"),x.value="success",h.value=!0,E.value=!1,await M()}catch(t){console.error(t),g.value=(t==null?void 0:t.message)||s("consultations.view.messages.acceptFailed"),x.value="error",h.value=!0}finally{H.value=!1}}async function Je(){K.value=!0;try{await q(Oe,{method:"POST"}),g.value=s("consultations.view.messages.offerRejected"),x.value="success",h.value=!0,$.value=!1,Ne.value="",await M()}catch(t){console.error(t),g.value=(t==null?void 0:t.message)||s("consultations.view.messages.rejectFailed"),x.value="error",h.value=!0}finally{K.value=!1}}const he=v(()=>A.value?A.value*Ve:0),We=v(()=>A.value?A.value+he.value:0),Qe=v(()=>oe(he.value)),B=v(()=>oe(We.value));return at(M),(t,a)=>{const _=Xe;return p(),z(ct,{fluid:"",class:"consultation-container"},{default:o(()=>[e(F,null,{default:o(()=>[e(T,{cols:"12",md:"3",class:"sidebar"},{default:o(()=>[n("div",gt,[e(C,{class:"sidebar-card",elevation:"2",rounded:"lg"},{default:o(()=>[e(S,{class:"pa-4"},{default:o(()=>[n("div",xt,[n("div",wt,l(i(s)("consultations.view.sidebar.statusTitle")),1),e(y,{color:ce(me.value),size:"small",label:"",class:"text-capitalize"},{default:o(()=>[e(d,{icon:"tabler-flag-3",class:"me-1"}),m(" "+l(re.value),1)]),_:1},8,["color"])]),n("div",yt,[n("div",kt,l(i(s)("consultations.view.sidebar.infoTitle")),1),n("div",Vt,[e(d,{icon:"tabler-hash",size:"18",class:"me-2 text-medium-emphasis"}),n("span",Ct,l(c.consultation_number||i(s)("common.na")),1)]),n("div",zt,[e(d,{icon:"tabler-calendar",size:"18",class:"me-2 text-medium-emphasis"}),n("span",Tt,l(c.date||i(s)("common.na")),1)]),n("div",St,[e(y,{size:"x-small",variant:"tonal",color:"primary",label:""},{default:o(()=>[e(d,{icon:"tabler-briefcase",class:"me-1"}),m(" "+l(ue.value),1)]),_:1})]),n("div",Ot,[e(y,{size:"x-small",variant:"tonal",color:"secondary",label:""},{default:o(()=>[e(d,{icon:"tabler-tag",class:"me-1"}),m(" "+l(de.value),1)]),_:1})])]),A.value!==null?(p(),w("div",At,[n("div",Nt,l(i(s)("consultations.view.sidebar.offerPriceTitle")),1),e(X,{class:"d-flex align-center justify-space-between pa-3 rounded-lg price-chip",border:""},{default:o(()=>[n("div",Rt,[e(d,{icon:"mdi-currency-usd",color:"primary"}),n("span",Ft,l(B.value),1)]),e(y,{size:"x-small",color:I.value?"success":"primary",variant:"tonal"},{default:o(()=>[m(l(I.value?i(s)("consultations.view.sidebar.accepted"):i(s)("consultations.view.sidebar.proposed")),1)]),_:1},8,["color"])]),_:1})])):b("",!0),c.handledby!=null?(p(),w("div",jt,[n("div",Pt,l(i(s)("consultations.view.sidebar.consultantTitle")),1),e(X,{class:"pa-3 rounded-lg",border:""},{default:o(()=>{var r,f,N;return[n("div",Ut,[e(ye,{size:"44",color:"primary",variant:"tonal",class:"me-3"},{default:o(()=>{var se,be;return[n("span",Et,l(Ge(((se=c.handledby)==null?void 0:se.name)||((be=c.handledby)==null?void 0:be.username)||"C")),1)]}),_:1}),n("div",$t,[n("div",It,l(((r=c.handledby)==null?void 0:r.name)||i(s)("common.na")),1),n("div",Lt,l(((f=c.handledby)==null?void 0:f.email)||((N=c.handledby)==null?void 0:N.username)||i(s)("common.na")),1)])])]}),_:1})])):b("",!0)]),_:1})]),_:1}),Fe.value?(p(),z(C,{key:0,class:"contact-card",elevation:"2",rounded:"lg"},{default:o(()=>[e(j,{class:"d-flex align-center"},{default:o(()=>[e(d,{icon:O(c.oppointment_method).icon,class:"me-2",color:O(c.oppointment_method).color},null,8,["icon","color"]),n("span",Dt,l(i(s)("consultations.view.sidebar.contactMethodTitle")),1)]),_:1}),e(S,null,{default:o(()=>[n("div",Mt,[e(y,{color:O(c.oppointment_method).color,size:"small",label:"",class:"text-capitalize mb-3"},{default:o(()=>[e(d,{icon:O(c.oppointment_method).icon,class:"me-1"},null,8,["icon"]),m(" "+l(O(c.oppointment_method).label),1)]),_:1},8,["color"]),n("div",Bt,[c.oppointment_date?(p(),w("div",qt,[e(y,{size:"x-small",variant:"tonal",color:"primary"},{default:o(()=>[e(d,{icon:"tabler-calendar",class:"me-1"}),m(" "+l(c.oppointment_date),1)]),_:1})])):b("",!0),c.oppointment_time?(p(),w("div",Gt,[e(y,{size:"x-small",variant:"tonal",color:"primary"},{default:o(()=>[e(d,{icon:"tabler-clock",class:"me-1"}),m(" "+l(c.oppointment_time),1)]),_:1})])):b("",!0),c.oppointment_method==="session"&&c.oppointment_url&&L.value?(p(),w("div",Ht,[e(k,{color:"success",variant:"flat",block:"",size:"small",href:c.oppointment_url},{default:o(()=>[e(d,{icon:"tabler-external-link",class:"me-2"}),m(" "+l(i(s)("consultations.view.sidebar.joinSession")),1)]),_:1},8,["href"])])):c.oppointment_method==="chat"&&L.value?(p(),w("div",Kt,[e(k,{color:"success",variant:"flat",block:"",size:"small",to:{name:"apps-consultations-chat-id",params:{id:c.id}}},{default:o(()=>[e(d,{icon:"tabler-external-link",class:"me-2"}),m(" "+l(i(s)("consultations.view.sidebar.joinChat")),1)]),_:1},8,["to"])])):b("",!0)])])]),_:1})]),_:1})):b("",!0)])]),_:1}),e(T,{cols:"12",md:"9"},{default:o(()=>[e(C,{class:"header-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[e(S,{class:"pa-6"},{default:o(()=>[e(F,{align:"center",class:"gy-2"},{default:o(()=>[e(T,{cols:"12",md:"8"},{default:o(()=>[n("h1",Zt,l(c.subject||i(s)("common.na")),1),n("div",Jt,[e(y,{variant:"outlined",size:"small",color:"primary",label:""},{default:o(()=>[e(d,{icon:"tabler-briefcase",class:"me-1"}),m(" "+l(ue.value),1)]),_:1}),e(y,{variant:"outlined",size:"small",color:"secondary",label:""},{default:o(()=>[e(d,{icon:"tabler-tag",class:"me-1"}),m(" "+l(de.value),1)]),_:1}),e(y,{size:"small",label:"",color:O(c.oppointment_method).label==="—"?"secondary":O(c.oppointment_method).color,class:"text-capitalize"},{default:o(()=>[e(d,{icon:O(c.oppointment_method).icon,class:"me-1"},null,8,["icon"]),m(" "+l(O(c.oppointment_method).label),1)]),_:1},8,["color"]),e(y,{color:ce(me.value),size:"small",label:"",class:"text-capitalize"},{default:o(()=>[e(d,{icon:"tabler-flag-3",class:"me-1"}),m(" "+l(re.value),1)]),_:1},8,["color"])]),n("p",Wt,l(c.description||i(s)("common.na")),1)]),_:1}),pe.value||fe.value?(p(),z(T,{key:0,cols:"12",md:"4",class:"text-md-end"},{default:o(()=>[n("div",Qt,[pe.value?(p(),z(k,{key:0,color:"success",size:"large",variant:"flat",loading:H.value,onClick:a[0]||(a[0]=r=>E.value=!0)},{default:o(()=>[e(d,{icon:"mdi-check-circle-outline",class:"me-2"}),m(" "+l(i(s)("consultations.view.actions.acceptOffer")),1)]),_:1},8,["loading"])):b("",!0),fe.value?(p(),z(k,{key:1,color:"error",size:"large",variant:"tonal",loading:K.value,onClick:a[1]||(a[1]=r=>$.value=!0)},{default:o(()=>[e(d,{icon:"mdi-close-circle-outline",class:"me-2"}),m(" "+l(i(s)("consultations.view.actions.rejectOffer")),1)]),_:1},8,["loading"])):b("",!0)]),n("div",Xt,l(i(s)("consultations.view.actions.respondToProceed")),1)]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1}),e(F,null,{default:o(()=>[e(T,{cols:"12",md:"6"},{default:o(()=>[e(C,{class:"attachments-card",elevation:"2",rounded:"lg"},{default:o(()=>[e(j,{class:"d-flex align-center"},{default:o(()=>[e(y,{size:"small",class:"ms-2 me-2",color:"primary",label:""},{default:o(()=>[e(d,{icon:"tabler-folder"})]),_:1}),n("span",Yt,l(i(s)("consultations.view.attachments.title")),1),e(y,{size:"small",class:"ms-2",color:ee.value>0?"primary":"secondary",label:""},{default:o(()=>[m(l(ee.value),1)]),_:1},8,["color"])]),_:1}),e(S,null,{default:o(()=>[ee.value>0?(p(),w("div",eo,[(p(!0),w(W,null,xe(c.attachments,(r,f)=>(p(),z(C,{key:f,class:"attachment-item",variant:"outlined",onClick:N=>Me(r)},{default:o(()=>[_e(r)?(p(),w("div",to,[n("img",{src:r,alt:i(s)("consultations.view.attachments.attachmentAlt",{n:f+1}),class:"attachment-image",onError:a[2]||(a[2]=N=>qe(N))},null,40,oo)])):(p(),w("div",ao,[e(d,{icon:Le(r),color:De(r),size:"64"},null,8,["icon","color"]),n("div",so,l(J(r).toUpperCase()),1)])),e(Q,{class:"pa-2 attachment-actions"},{default:o(()=>[e(G),e(rt,{text:i(s)("consultations.view.attachments.preview"),location:"top"},{activator:o(({props:N})=>[e(k,st({ref_for:!0},N,{size:"small",variant:"tonal",color:"primary",onClick:le(se=>Be(r),["stop"]),class:"action-btn"}),{prepend:o(()=>[e(d,{icon:"tabler-external-link"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))])):(p(),w("div",lo,[e(d,{icon:"mdi-folder-open-outline",size:"64",class:"text-medium-emphasis mb-2"}),n("div",no,l(i(s)("consultations.view.attachments.empty")),1)]))]),_:1})]),_:1})]),_:1}),e(T,{cols:"12",md:"6"},{default:o(()=>[A.value!==null?(p(),z(C,{key:0,class:"offer-price-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[e(S,{class:"pa-5"},{default:o(()=>[n("div",io,[n("div",co,[e(ye,{color:"primary",variant:"tonal",size:"44",class:"mr-3"},{default:o(()=>[e(d,{icon:"mdi-currency-usd"})]),_:1}),n("div",null,[n("div",ro,l(i(s)("consultations.view.offer.currentOffer")),1),n("div",uo,l(B.value),1)])]),n("div",mo,[e(y,{color:I.value||L.value?"success":"primary",variant:"tonal",class:"font-weight-600"},{default:o(()=>[m(l(I.value?i(s)("consultations.view.offer.waitingPayment"):L.value?i(s)("consultations.view.offer.paid"):te.value?i(s)("consultations.view.offer.waitingClientApproval"):""),1)]),_:1},8,["color"])])]),e(X,{class:"mt-4 pa-4",color:"blue-lighten-5",rounded:"lg",elevation:"0"},{default:o(()=>[n("div",po,l(i(s)("consultations.view.offer.offerDetails")),1),e(ut,{class:"elevation-0 rounded-lg offer-table"},{default:o(()=>[n("tbody",null,[n("tr",null,[n("td",fo,l(i(s)("consultations.view.offer.beforeTax")),1),n("td",vo,l(Ue.value),1)]),n("tr",null,[n("td",_o,l(i(s)("consultations.view.offer.tax",{rate:Ve*100})),1),n("td",ho,l(Qe.value),1)]),n("tr",null,[n("td",bo,l(i(s)("consultations.view.offer.totalToPay")),1),n("td",go,[e(y,{color:"primary",variant:"flat",class:"px-4 py-2 font-weight-bold"},{default:o(()=>[m(l(B.value),1)]),_:1})])])])]),_:1}),n("div",xo,[e(d,{icon:"mdi-information-outline",size:"16",class:"mr-1"}),n("span",null,l(i(s)("consultations.view.offer.totalIncludes")),1)])]),_:1}),e(dt,{type:"info",variant:"tonal",class:"mt-4",density:"comfortable"},{default:o(()=>[n("div",wo,l(i(s)("consultations.view.offer.consultantResponseTitle")),1),n("div",yo,[L.value&&c.consultant_response!=null?(p(),w(W,{key:0},[m(l(c.consultant_response),1)],64)):i(P).can("accept","offer")?(p(),w(W,{key:1},[m(l(i(s)("consultations.view.offer.consultantResponseHint")),1)],64)):b("",!0)])]),_:1})]),_:1})]),_:1})):b("",!0),i(P).can("write","offer")&&Pe.value?(p(),z(C,{key:1,class:"offer-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[e(j,{class:"d-flex align-center"},{default:o(()=>[e(d,{icon:"mdi-currency-usd",class:"me-2",color:"primary"}),n("span",ko,l(i(s)("consultations.view.makeOffer.title")),1)]),_:1}),e(S,null,{default:o(()=>[e(ke,{onSubmit:le(He,["prevent"])},{default:o(()=>[e(mt,{modelValue:u.price,"onUpdate:modelValue":a[3]||(a[3]=r=>u.price=r),label:i(s)("consultations.view.makeOffer.priceLabel"),type:"text",prefix:"SAR",required:"",rules:$e,class:"mb-4"},null,8,["modelValue","label"]),je.value?(p(),w("div",Vo,[e(F,null,{default:o(()=>[e(T,{cols:"12"},{default:o(()=>[e(X,{variant:"flat",class:"section-bar bg-grey-lighten-3"},{default:o(()=>[n("div",Co,[e(d,{icon:"tabler-messages"}),n("span",zo,l(i(s)("consultations.view.makeOffer.contactMethodsOptional")),1)])]),_:1})]),_:1}),(p(!0),w(W,null,xe(ve.value,r=>(p(),z(T,{cols:"12",md:"6",key:r.key},{default:o(()=>[e(C,{class:we(["method-card soft-card",[r.className,{"is-selected":u.oppointment_method===r.key}]]),variant:"outlined",onClick:f=>Ee(r.key)},{default:o(()=>[e(S,{class:"text-center"},{default:o(()=>[n("div",To,[e(d,{icon:r.icon,size:"32"},null,8,["icon"])]),n("div",So,l(r.title[Z.value]),1)]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1}),u.oppointment_method?(p(),z(F,{key:0},{default:o(()=>[e(T,{cols:"12"},{default:o(()=>{var r;return[e(C,{class:we(["details-card",(r=ve.value.find(f=>f.key===u.oppointment_method))==null?void 0:r.className]),variant:"outlined"},{default:o(()=>[e(S,null,{default:o(()=>[n("div",Oo,[e(d,{icon:u.oppointment_method==="session"?"tabler-video":"tabler-message-circle"},null,8,["icon"]),n("span",null,l(u.oppointment_method==="session"?i(s)("consultations.view.makeOffer.videoCall"):i(s)("consultations.view.makeOffer.instantChat")),1)]),e(pt,{class:"my-4"}),e(F,null,{default:o(()=>[e(T,{cols:"12",md:"6"},{default:o(()=>[e(_,{modelValue:u.oppointment_date,"onUpdate:modelValue":a[4]||(a[4]=f=>u.oppointment_date=f),type:"date",label:i(s)("consultations.view.makeOffer.appointmentDate"),"prepend-inner-icon":"tabler-calendar"},null,8,["modelValue","label"])]),_:1}),e(T,{cols:"12",md:"6"},{default:o(()=>[e(_,{modelValue:u.oppointment_time,"onUpdate:modelValue":a[5]||(a[5]=f=>u.oppointment_time=f),type:"time",label:i(s)("consultations.view.makeOffer.time"),"prepend-inner-icon":"tabler-clock"},null,8,["modelValue","label"])]),_:1}),u.oppointment_method==="session"?(p(),z(T,{key:0,cols:"12"},{default:o(()=>[e(_,{modelValue:u.oppointment_url,"onUpdate:modelValue":a[6]||(a[6]=f=>u.oppointment_url=f),label:i(s)("consultations.view.makeOffer.sessionUrl"),placeholder:i(s)("consultations.view.makeOffer.sessionUrlPlaceholder"),"prepend-inner-icon":"tabler-link"},null,8,["modelValue","label","placeholder"])]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1},8,["class"])]}),_:1})]),_:1})):b("",!0)])):b("",!0),e(k,{color:"primary",size:"large",type:"submit",loading:R.value,block:"",class:"mt-5"},{default:o(()=>[e(d,{icon:"mdi-send",class:"me-2"}),m(" "+l(i(s)("consultations.view.makeOffer.sendOffer")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})):b("",!0),i(P).can("answer","consultation")&&I.value?(p(),z(C,{key:2,class:"consultation-text-card mb-4",elevation:"2",rounded:"lg"},{default:o(()=>[e(j,{class:"d-flex align-center"},{default:o(()=>[e(d,{icon:"mdi-message-text",class:"me-2",color:"primary"}),n("span",Ao,l(i(s)("consultations.view.consultantText.title")),1)]),_:1}),e(S,null,{default:o(()=>[e(ke,{onSubmit:le(Ke,["prevent"])},{default:o(()=>[e(ft,{modelValue:u.consultant_response,"onUpdate:modelValue":a[7]||(a[7]=r=>u.consultant_response=r),label:i(s)("consultations.view.consultantText.responseLabel"),rows:"5",class:"mb-4","auto-grow":"",placeholder:i(s)("consultations.view.consultantText.responsePlaceholder")},null,8,["modelValue","label","placeholder"]),e(k,{color:"primary",size:"large",type:"submit",loading:R.value,block:""},{default:o(()=>[e(d,{icon:"mdi-content-save",class:"me-2"}),m(" "+l(i(s)("consultations.view.consultantText.sendResponse")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})):b("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(ne,{modelValue:D.value,"onUpdate:modelValue":a[10]||(a[10]=r=>D.value=r),"max-width":"800"},{default:o(()=>[e(C,null,{default:o(()=>[e(vt,{color:"primary",density:"compact"},{default:o(()=>[e(_t,null,{default:o(()=>[m(l(i(s)("consultations.view.preview.title")),1)]),_:1}),e(G),e(k,{icon:"",onClick:a[8]||(a[8]=r=>D.value=!1)},{default:o(()=>[e(d,null,{default:o(()=>a[16]||(a[16]=[m("mdi-close")])),_:1,__:[16]})]),_:1})]),_:1}),e(ht,{src:ae.value,"max-height":"600",contain:""},null,8,["src"]),e(Q,null,{default:o(()=>[e(G),e(k,{color:"primary",href:ae.value,target:"_blank",download:""},{default:o(()=>[e(d,{icon:"mdi-download",class:"me-2"}),m(" "+l(i(s)("consultations.view.preview.download")),1)]),_:1},8,["href"]),e(k,{onClick:a[9]||(a[9]=r=>D.value=!1)},{default:o(()=>[m(l(i(s)("common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ne,{modelValue:E.value,"onUpdate:modelValue":a[12]||(a[12]=r=>E.value=r),"max-width":"480"},{default:o(()=>[e(C,null,{default:o(()=>[e(j,{class:"d-flex align-center"},{default:o(()=>[e(d,{icon:"mdi-check-circle-outline",class:"me-2",color:"success"}),m(" "+l(i(s)("consultations.view.confirm.acceptTitle")),1)]),_:1}),e(S,null,{default:o(()=>[m(l(i(s)("consultations.view.confirm.acceptText",{total:B.value})),1)]),_:1}),e(Q,null,{default:o(()=>[e(G),e(k,{variant:"text",onClick:a[11]||(a[11]=r=>E.value=!1)},{default:o(()=>[m(l(i(s)("common.cancel")),1)]),_:1}),e(k,{color:"success",loading:H.value,onClick:Ze},{default:o(()=>[e(d,{icon:"mdi-check",class:"me-2"}),m(" "+l(i(s)("consultations.view.actions.accept")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ne,{modelValue:$.value,"onUpdate:modelValue":a[14]||(a[14]=r=>$.value=r),"max-width":"520"},{default:o(()=>[e(C,null,{default:o(()=>[e(j,{class:"d-flex align-center"},{default:o(()=>[e(d,{icon:"mdi-close-circle-outline",class:"me-2",color:"error"}),m(" "+l(i(s)("consultations.view.confirm.rejectTitle")),1)]),_:1}),e(S,null,{default:o(()=>[m(l(i(s)("consultations.view.confirm.rejectText",{total:B.value})),1)]),_:1}),e(Q,null,{default:o(()=>[e(G),e(k,{variant:"text",onClick:a[13]||(a[13]=r=>$.value=!1)},{default:o(()=>[m(l(i(s)("common.cancel")),1)]),_:1}),e(k,{color:"error",loading:K.value,onClick:Je},{default:o(()=>[e(d,{icon:"mdi-close",class:"me-2"}),m(" "+l(i(s)("consultations.view.actions.reject")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(bt,{modelValue:h.value,"onUpdate:modelValue":a[15]||(a[15]=r=>h.value=r),color:x.value,timeout:"3000"},{default:o(()=>[m(l(g.value),1)]),_:1},8,["modelValue","color"])]),_:1})}}},ya=it(No,[["__scopeId","data-v-33c1edf6"]]);export{ya as default};

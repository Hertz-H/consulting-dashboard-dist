import{r as P,p as I,c as N}from"./validators-DOkm11CL.js";import{r as i,u as k,O as S,f as C,o as w,e as o,b as t,s as _,t as h,aF as T,l as c,a2 as x,aW as D,c as F}from"./index-BVpKynl4.js";import{_ as U}from"./AppTextField-BlxqpuS8.js";import{$ as j}from"./api-DA_9kprT.js";import{a as f,V as y}from"./VRow-ZTOT4Z3s.js";import{V as M}from"./VCard-CcIsawTw.js";import{V as R}from"./VCardText-ZhV-99WX.js";import{V as O}from"./VSnackbar-CnV7cy9h.js";import{V as $}from"./VAlert-csVW849v.js";import{V as H}from"./VForm-BXdIeyJa.js";import{u as W}from"./useApi-C1A9lyWN.js";import"./helpers-DK5QwNv0.js";import"./form-BTaXsSip.js";import"./VTextField-DPG1ptcm.js";/* empty css                   */import"./VCounter-BrEPeYtP.js";import"./VImg-B5byWgVS.js";import"./VField-hxsHU2Y6.js";import"./easing-Bybner-F.js";import"./VInput-ts4WNp2Q.js";import"./forwardRefs-C-GTDzx5.js";import"./index-CvOPxmL5.js";/* empty css              */import"./VAvatar-QJTJwQfz.js";import"./VOverlay-DwBuqUsh.js";import"./delay-GoSZAG7F.js";import"./lazy-BKTO8477.js";import"./scopeId-DCEPhMdw.js";const z={__name:"UserTabSecurity",setup(A){const u=i(!1),d=i(!1),r=i(""),l=i(""),b=k(),n=i(!1),m=i(""),p=i("deep-purple-accent-4"),V=i(!1);async function q(e){if(e&&e.status&&!e.ok)try{return await e.json()}catch{return{message:`API Error (Status ${e.status})`}}return{message:(e==null?void 0:e.message)||"Network error"}}const B=S(()=>({password:r.value,password_confirmation:l.value})),E=async()=>{if(!r.value||!l.value){m.value="Please fill all required fields.",p.value="error",n.value=!0;return}if(r.value!==l.value){m.value="Passwords do not match.",p.value="error",n.value=!0;return}V.value=!0;try{await j(`/v1/users/${b.params.id}/changePassword`,{method:"PATCH",body:B.value,onResponseError({response:e}){var s,g;const a=((s=e==null?void 0:e._data)==null?void 0:s.errors)||{},v=Object.values(a).flat().filter(Boolean).join(`
`);m.value=v||(((g=e==null?void 0:e._data)==null?void 0:g.message)??"Failed to change password."),p.value="error",n.value=!0}}),m.value="Password changed successfully.",p.value="success",n.value=!0,r.value="",l.value=""}catch(e){const a=await q(e);m.value=(a==null?void 0:a.message)||"An unexpected error occurred.",p.value="error",n.value=!0}finally{V.value=!1}};return(e,a)=>{const v=U;return w(),C(y,null,{default:o(()=>[t(f,{cols:"12"},{default:o(()=>[t(M,{title:"Change Password"},{default:o(()=>[t(R,null,{default:o(()=>[t(O,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value=s),timeout:2400,color:p.value,class:"elevation-24",location:"top right"},{default:o(()=>[_(h(m.value),1)]),_:1},8,["modelValue","color"]),t($,{closable:"",variant:"tonal",color:"warning",class:"mb-4",title:"Ensure that these requirements are met",text:"Minimum 8 characters long, uppercase & symbol"}),t(H,{onSubmit:T(E,["prevent"])},{default:o(()=>[t(y,null,{default:o(()=>[t(f,{cols:"12",md:"6"},{default:o(()=>[t(v,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s),label:"New Password",placeholder:"············",rules:["requiredValidator"in e?e.requiredValidator:c(P),"passwordValidator"in e?e.passwordValidator:c(I)],type:u.value?"text":"password","append-inner-icon":u.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[2]||(a[2]=s=>u.value=!u.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),t(f,{cols:"12",md:"6"},{default:o(()=>[t(v,{modelValue:l.value,"onUpdate:modelValue":a[3]||(a[3]=s=>l.value=s),label:"Confirm Password",autocomplete:"confirm-password",placeholder:"············",rules:["requiredValidator"in e?e.requiredValidator:c(P),("confirmedValidator"in e?e.confirmedValidator:c(N))(l.value,r.value)],type:d.value?"text":"password","append-inner-icon":d.value?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[4]||(a[4]=s=>d.value=!d.value)},null,8,["modelValue","rules","type","append-inner-icon"])]),_:1}),t(f,{cols:"12"},{default:o(()=>[t(x,{type:"submit",loading:V.value,color:"primary"},{default:o(()=>a[5]||(a[5]=[_(" Change Password ")])),_:1,__:[5]},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},G={key:1},ge={__name:"[id]",async setup(A){let u,d;const r=k();i(null);const{data:l}=([u,d]=D(()=>W(`/v1/users/${r.params.id}`)),u=await u,d(),u);return console.log(l.value),(b,n)=>c(l)?(w(),C(y,{key:0},{default:o(()=>[t(f,{cols:"12",md:"7",lg:"8"},{default:o(()=>[t(z)]),_:1})]),_:1})):(w(),F("div",G,[t($,{type:"error",variant:"tonal"},{default:o(()=>[_(" Invoice with ID "+h(c(r).params.id)+" not found! ",1)]),_:1})]))}};export{ge as default};

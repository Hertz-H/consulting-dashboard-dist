import{ba as L,u as N,aj as T,al as z,O as l,aM as P,r as v,bb as V,E as U,w as A,f as w,o as n,e as h,b as d,c as r,d as t,t as o,l as x,k as F,F as y,h as E,v as I,aY as O,au as H}from"./index-DLyiUI4T.js";import{u as J}from"./useChatStore-DNzlF3r8.js";import{C as R}from"./vue3-perfect-scrollbar-CYNmQCJN.js";import{a as Y,V as q}from"./VMain-DsFQ0MwL.js";import{V as G}from"./VSpacer-DoPoSCZt.js";import{V as K}from"./VDivider-DZkdhmn8.js";import{V as S}from"./VAvatar-GwUQM--D.js";import"./useApi-B07hdb0V.js";import"./createUrl-Ch6EJdVn.js";import"./index-CvOPxmL5.js";import"./api-BtdnJSD2.js";import"./ssrBoot-Co57-A6O.js";/* empty css              */import"./VImg-W922IUCz.js";const Q={key:0,class:"d-flex flex-column h-100"},W={class:"active-chat-header d-flex align-center text-medium-emphasis bg-surface"},X={class:"text-h6 font-weight-regular"},Z={class:"pa-4"},ee={key:0,class:"d-flex align-center justify-center h-100"},te={class:"text-center text-medium-emphasis"},se={class:"d-flex flex-column align-start message-wrapper"},ae={class:"sender-name mb-1"},oe={class:"chat-bubble theirs"},ne={class:"message-text"},re={class:"time-caption"},ie={class:"d-flex flex-column align-end message-wrapper"},ce={class:"sender-name text-end mb-1"},le={class:"chat-bubble mine"},ue={class:"message-text"},de={class:"time-caption"},he={key:1,class:"d-flex h-100 align-center justify-center flex-column"},me={key:1,class:"text-center text-disabled"},De={__name:"[id]",setup(pe){L(e=>({"3d718c4e":B.value}));const $=N(),g=J(),{name:j}=T(),{t:m}=z(),b=l(()=>$.params.id),p=l(()=>{const e=P("userData").value;return e?typeof e=="string"?JSON.parse(e):e:null}),D=l(()=>p.value&&(`${p.value.first_name||""} ${p.value.last_name||""}`.trim()||p.value.name)||""),i=l(()=>g.consultationChat),_=l(()=>{var e;return(e=i.value)!=null&&e.chat?i.value.chat.map(a=>({id:a.id,text:a.message,sender:a.sender,date:a.date,isMine:a.sender===D.value})):[]}),M=l(()=>i.value?`${i.value.consultation_number} - ${i.value.subject||m("consultations.chat.defaultSubject")}`:m("consultations.chat.title"));v("");const f=v(null);v(!1);const k=()=>{H(()=>{var a;const e=((a=f.value)==null?void 0:a.$el)||f.value;e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})},C=e=>{if(!e)return"";try{const[a,s,c]=e.split("-");return new Date(`${c}-${s}-${a}`).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return e}},B=l(()=>{var a,s;let e="transparent";return V&&(e=(s=(a=V)==null?void 0:a[j.value].colors)==null?void 0:s.background),e});return U(async()=>{b.value&&(await g.getConsultationChat(b.value),k())}),A(_,()=>{k()},{deep:!0}),(e,a)=>(n(),w(q,{class:"chat-app-layout",style:{"z-index":"0"}},{default:h(()=>[d(Y,{class:"chat-content-container",style:{width:"100%"}},{default:h(()=>[i.value?(n(),r("div",Q,[t("div",W,[t("div",X,o(M.value),1),d(G)]),d(K),d(x(R),{ref_key:"chatLogPS",ref:f,tag:"div",options:{wheelPropagation:!1},class:"flex-grow-1"},{default:h(()=>[t("div",Z,[_.value.length===0?(n(),r("div",ee,[t("div",te,[t("p",null,o(x(m)("consultations.chat.emptyMessages")),1)])])):F("",!0),(n(!0),r(y,null,E(_.value,s=>(n(),r("div",{key:s.id,class:I(["d-flex mb-4 align-start message-container",s.isMine?"justify-end":"justify-start"])},[s.isMine?(n(),r(y,{key:1},[t("div",ie,[t("div",ce,o(s.sender),1),t("div",le,[t("div",ue,o(s.text),1),t("div",de,o(C(s.date)),1)])]),d(S,{size:"36",class:"ms-2 flex-shrink-0",variant:"tonal",color:"primary"},{default:h(()=>{var c,u;return[t("span",null,o(((u=(c=s.sender)==null?void 0:c.charAt(0))==null?void 0:u.toUpperCase())||"?"),1)]}),_:2},1024)],64)):(n(),r(y,{key:0},[d(S,{size:"36",class:"me-2 flex-shrink-0",variant:"tonal",color:"primary"},{default:h(()=>{var c,u;return[t("span",null,o(((u=(c=s.sender)==null?void 0:c.charAt(0))==null?void 0:u.toUpperCase())||"?"),1)]}),_:2},1024),t("div",se,[t("div",ae,o(s.sender),1),t("div",oe,[t("div",ne,o(s.text),1),t("div",re,o(C(s.date)),1)])])],64))],2))),128))])]),_:1},512)])):(n(),r("div",he,[i.value?(n(),r("div",me,[t("p",null,o(x(m)("consultations.chat.notFound")),1)])):(n(),w(O,{key:0,indeterminate:"",color:"primary"}))]))]),_:1})]),_:1}))}};export{De as default};

import{_ as re}from"./TablePagination-BS9zVhTb.js";import{_ as ue}from"./AppDateTimePicker-210KZKjd.js";import{_ as ce}from"./AppSelect-Cz12NtqF.js";import{_ as de}from"./AppTextField-6Zt2y8Qn.js";import{u as me}from"./useApi-B07hdb0V.js";import{c as pe}from"./createUrl-Ch6EJdVn.js";import{$ as ve}from"./api-BtdnJSD2.js";import{V as fe}from"./VNavigationDrawer-SPuJxpsz.js";import{V as Y}from"./VCard-Bp3Y2g69.js";import{V as G,a as _e}from"./VToolbar-DELVTIuK.js";import{V as J}from"./VSpacer-DoPoSCZt.js";import{al as be,r as c,w as K,aX as ge,O as x,c as O,b as l,e as i,a as ye,o as z,s as m,t as s,l as r,a2 as P,a9 as p,d as n,F as W,h as he,f as Ve,k as xe,v as Pe,p as we}from"./index-DLyiUI4T.js";import{V as B}from"./VDivider-DZkdhmn8.js";import{V as ke}from"./VSheet-0pTeeTvA.js";import{V as Te}from"./VCardText-CNPcEnqc.js";import{V as Ce,a as Se}from"./VRow-BThkmVdP.js";import{V as M}from"./VAvatar-GwUQM--D.js";import{V as Ne}from"./VDataTableServer-oIz8JhZR.js";import{V as $e}from"./VMenu-CnM5Ce9N.js";import{V as Ae,a as Z,b as ee}from"./VList-BLAOQF4q.js";import{V as De}from"./VTooltip-CSrzKlAr.js";import"./VPagination-CevEurIF.js";import"./VField-DJvLbBqg.js";import"./VLabel-Bj0ZLaaG.js";import"./form-4FzIkTDC.js";import"./easing-Bybner-F.js";import"./VInput-CZKa1bvG.js";import"./VImg-W922IUCz.js";import"./VSelect-xtg9jf9g.js";import"./VTextField-D_VDXh9N.js";/* empty css                   */import"./VCounter-DSUdNhJf.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-B2cZjoh4.js";import"./VOverlay-BpuXFPpY.js";import"./delay-CJQMA8o3.js";import"./lazy-D7mfu-eq.js";import"./scopeId-BqXwnYFS.js";import"./VCheckboxBtn-DpT_qdyT.js";import"./VSelectionControl-DGmCswqu.js";import"./VChip-C_HpRD3G.js";import"./VSlideGroup-BBTw8Lc6.js";import"./index-CvOPxmL5.js";import"./ssrBoot-Co57-A6O.js";/* empty css              */import"./VDataTable-CZ-vN8BX.js";import"./VTable-C-5dAhBS.js";import"./filter-sNEpt0hK.js";const Le={class:"text-body-2 font-weight-medium mb-1 d-block"},Ue={class:"text-body-2 font-weight-medium mb-1 d-block"},Ie={class:"text-body-2 font-weight-medium mb-1 d-block"},Fe={class:"text-body-2 font-weight-medium mb-1 d-block"},Re={class:"d-flex gap-2"},ze={class:"d-flex justify-space-between mt-2"},Be={class:"d-flex flex-column"},je={class:"text-h4"},Ee={class:"text-body-1 text-capitalize"},Oe={class:"d-flex gap-4 align-center flex-wrap"},Me={class:"d-flex align-center gap-2"},qe={class:"text-medium-emphasis text-body-2"},He={class:"pa-8 text-center"},Qe={class:"text-h6 mb-1"},Xe={class:"text-body-2 text-medium-emphasis mb-4"},Ye={class:"mb-0"},Ge={class:"mb-0"},Je={class:"d-flex align-center"},Ke={class:"d-flex flex-column"},We={class:"text-link font-weight-medium"},Ze={class:"text-sm text-medium-emphasis"},et={class:"text-sm text-medium-emphasis"},Jt={__name:"index",async setup(tt){let $,q;const{t:o}=be(),w=c(""),k=c(null),A=c([]),T=c(null),C=c(null),S=c(null),N=c(!1),b=c(void 0),g=c(void 0),v=c(10),f=c(1),D=c(),L=c(),te=t=>{var e,u,d,y;D.value=(u=(e=t.sortBy)==null?void 0:e[0])==null?void 0:u.key,L.value=(y=(d=t.sortBy)==null?void 0:d[0])==null?void 0:y.order,v.value=t.itemsPerPage,f.value=t.page},U=t=>Number(t??0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),ae=t=>t?t.split(" ").map(e=>e[0]).join("").toUpperCase():"?",V=t=>t?t instanceof Date?t.toISOString().slice(0,10):String(t).slice(0,10):void 0,le=t=>{const e=String(t||"").toLowerCase();return e==="paid"?o("invoicesPage.status.paid"):e==="unpaid"?o("invoicesPage.status.unpaid"):e==="cancelled"?o("invoicesPage.status.cancelled"):t||"â€”"};K(T,t=>{if(!t){b.value=void 0,g.value=void 0;return}if(Array.isArray(t)){const[e,u]=t;b.value=V(e),g.value=V(u);return}if(typeof t=="object"){b.value=V(t.start),g.value=V(t.end);return}if(typeof t=="string"){const e=t.split(" to ");b.value=V(e[0]||""),g.value=V(e[1]||"");return}b.value=void 0,g.value=void 0},{immediate:!0});const H=()=>{w.value="",k.value=null,T.value=null,C.value=null,S.value=null,b.value=void 0,g.value=void 0,f.value=1,D.value=void 0,L.value=void 0},{data:j,execute:Q}=([$,q]=ge(()=>me(pe("/v1/invoices",{query:{search:w,status:k,issued_from:b,issued_to:g,min_total:C,max_total:S,itemsPerPage:v,page:f,sortBy:D,orderBy:L}}))),$=await $,q(),$);K([w,k,T,C,S,v,f,D,L],()=>Q(),{immediate:!0});const E=x(()=>{var R;const t=((R=j.value)==null?void 0:R.summary)??{},e=h=>typeof h=="number"?h:h&&typeof h=="object"?Number(h.total??0):0,u=(t.paid!==void 0?e(t.paid):void 0)??Number(t.paid_total??t.paidTotal??0),d=(t.unpaid!==void 0?e(t.unpaid):void 0)??Number(t.unpaid_total??t.unpaidTotal??0),y=(t.cancelled!==void 0?e(t.cancelled):void 0)??Number(t.cancelled_total??t.cancelledTotal??0);return{paid:{total:Number.isFinite(u)?u:0},unpaid:{total:Number.isFinite(d)?d:0},cancelled:{total:Number.isFinite(y)?y:0},clients_count:Number(t.clients_count??t.clientsCount??0),consultants_count:Number(t.consultants_count??t.consultantsCount??0)}}),I=x(()=>{var t,e;return((e=(t=j.value)==null?void 0:t.meta)==null?void 0:e.total)??0}),F=x(()=>{var t,e,u,d;return[{title:o("invoicesPage.widgets.clients"),value:E.value.clients_count??0,icon:"tabler-user",color:"primary"},{title:o("invoicesPage.widgets.invoices"),value:I.value??0,icon:"tabler-file-invoice",color:"info"},{title:o("invoicesPage.widgets.paid"),value:`SAR ${U(((e=(t=E.value)==null?void 0:t.paid)==null?void 0:e.total)??0)}`,icon:"tabler-checks",color:"success"},{title:o("invoicesPage.widgets.unpaid"),value:`SAR ${U(((d=(u=E.value)==null?void 0:u.unpaid)==null?void 0:d.total)??0)}`,icon:"tabler-circle-off",color:"warning"}]}),ie=x(()=>[{title:o("invoicesPage.status.paid"),value:"paid"},{title:o("invoicesPage.status.unpaid"),value:"unpaid"},{title:o("invoicesPage.status.cancelled"),value:"cancelled"}]),oe=x(()=>[{title:o("invoicesPage.table.headers.invoiceNumber"),key:"invoice_number"},{title:o("invoicesPage.table.headers.status"),key:"status",sortable:!1},{title:o("invoicesPage.table.headers.client"),key:"client",sortable:!1},{title:o("invoicesPage.table.headers.total"),key:"total"},{title:o("invoicesPage.table.headers.issuedDate"),key:"issued_at"},{title:o("invoicesPage.table.headers.actions"),key:"actions",sortable:!1}]),se=x(()=>{var t;return(((t=j.value)==null?void 0:t.data)??[]).map(e=>({id:e.id,invoice_number:e.invoice_number,status:e.status,client_name:e.client_name,client_email:e.client_email,client_phone:e.client_phone,consultant_name:e.consultant_name,total:Number(e.total),issued_at:e.issued_at,due_at:e.due_at}))}),X=t=>{const e=String(t||"").toLowerCase();return e==="paid"?{variant:"success",icon:"tabler-check"}:e==="unpaid"?{variant:"warning",icon:"tabler-circle-off"}:e==="cancelled"?{variant:"secondary",icon:"tabler-ban"}:{variant:"secondary",icon:"tabler-help"}},ne=async t=>{await ve(`/v1/invoices/${t}`,{method:"DELETE"});const e=A.value.findIndex(u=>u===t);e!==-1&&A.value.splice(e,1),Q()};return(t,e)=>{const u=de,d=ce,y=ue,R=ye("RouterLink"),h=re;return z(),O("section",null,[l(fe,{modelValue:N.value,"onUpdate:modelValue":e[7]||(e[7]=a=>N.value=a),location:"end",temporary:"",scrim:!1,width:"360",class:"invoice-filter-drawer",color:"background"},{default:i(()=>[l(G,{flat:""},{default:i(()=>[l(_e,null,{default:i(()=>[m(s(r(o)("invoicesPage.filters.title")),1)]),_:1}),l(J),l(P,{icon:"",variant:"text",onClick:e[0]||(e[0]=a=>N.value=!1)},{default:i(()=>[l(p,{icon:"tabler-x"})]),_:1})]),_:1}),l(B),l(ke,{class:"pa-4 d-flex flex-column gap-4 invoice-filter-sheet",elevation:"0"},{default:i(()=>[n("div",null,[n("span",Le,s(r(o)("invoicesPage.filters.searchLabel")),1),l(u,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a),placeholder:r(o)("invoicesPage.filters.searchPlaceholder"),density:"compact"},null,8,["modelValue","placeholder"])]),n("div",null,[n("span",Ue,s(r(o)("invoicesPage.filters.statusLabel")),1),l(d,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=a=>k.value=a),items:ie.value,placeholder:r(o)("invoicesPage.filters.statusPlaceholder"),clearable:"","clear-icon":"tabler-x",density:"compact"},null,8,["modelValue","items","placeholder"])]),n("div",null,[n("span",Ie,s(r(o)("invoicesPage.filters.issuedRangeLabel")),1),l(y,{modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=a=>T.value=a),config:{mode:"range",dateFormat:"Y-m-d"},placeholder:r(o)("invoicesPage.filters.issuedRangePlaceholder")},null,8,["modelValue","placeholder"])]),n("div",null,[n("span",Fe,s(r(o)("invoicesPage.filters.totalRangeLabel")),1),n("div",Re,[l(u,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=a=>C.value=a),type:"number",placeholder:r(o)("invoicesPage.filters.minTotalPlaceholder"),density:"compact"},null,8,["modelValue","placeholder"]),l(u,{modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=a=>S.value=a),type:"number",placeholder:r(o)("invoicesPage.filters.maxTotalPlaceholder"),density:"compact"},null,8,["modelValue","placeholder"])])]),l(B,{class:"my-2"}),n("div",ze,[l(P,{variant:"outlined",color:"secondary",onClick:H},{default:i(()=>[l(p,{icon:"tabler-refresh",class:"me-1"}),m(" "+s(r(o)("invoicesPage.filters.reset")),1)]),_:1}),l(P,{class:"invoice-filter-btn",variant:"text","prepend-icon":"tabler-filter",onClick:e[6]||(e[6]=a=>N.value=!1)},{default:i(()=>[m(s(r(o)("invoicesPage.filters.applyAndClose")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"]),l(Y,{class:"mb-6"},{default:i(()=>[l(Te,{class:"px-3"},{default:i(()=>[l(Ce,null,{default:i(()=>[(z(!0),O(W,null,he(F.value,(a,_)=>(z(),O(W,{key:_},[l(Se,{cols:"12",sm:"6",md:"3",class:"px-6"},{default:i(()=>[n("div",{class:Pe(["d-flex justify-space-between align-center",t.$vuetify.display.xs?_!==F.value.length-1?"border-b pb-4":"":t.$vuetify.display.sm&&_<F.value.length/2?"border-b pb-4":""])},[n("div",Be,[n("h4",je,s(a.value),1),n("span",Ee,s(a.title),1)]),l(M,{color:a.color,variant:"tonal",rounded:"",size:"42"},{default:i(()=>[l(p,{icon:a.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])],2)]),_:2},1024),(t.$vuetify.display.mdAndUp?_!==F.value.length-1:t.$vuetify.display.smAndUp&&_%2===0)?(z(),Ve(B,{key:0,vertical:"",inset:"",length:"60"})):xe("",!0)],64))),128))]),_:1})]),_:1})]),_:1}),l(Y,{id:"invoice-list"},{default:i(()=>[l(G,{flat:"",density:"comfortable",class:"px-4"},{default:i(()=>[n("div",Oe,[n("div",Me,[n("span",null,s(r(o)("invoicesPage.table.show")),1),l(d,{"model-value":v.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"5.5rem"},"onUpdate:modelValue":e[8]||(e[8]=a=>v.value=parseInt(a,10))},null,8,["model-value"])]),n("span",qe,s(r(o)("invoicesPage.table.totalLabel",{count:I.value})),1)]),l(J),l(P,{class:"invoice-filter-btn",variant:"text","prepend-icon":"tabler-filter",onClick:e[9]||(e[9]=a=>N.value=!0)},{default:i(()=>[m(s(r(o)("invoicesPage.filters.title")),1)]),_:1})]),_:1}),l(B),l(Ne,{"model-value":A.value,"onUpdate:modelValue":e[11]||(e[11]=a=>A.value=a),"items-per-page":v.value,"onUpdate:itemsPerPage":e[12]||(e[12]=a=>v.value=a),page:f.value,"onUpdate:page":e[13]||(e[13]=a=>f.value=a),"items-length":I.value,headers:oe.value,items:se.value,"item-value":"id",class:"text-no-wrap","onUpdate:options":te},{"no-data":i(()=>[n("div",He,[l(p,{icon:"tabler-file-invoice",size:"40",class:"mb-2"}),n("div",Qe,s(r(o)("invoicesPage.table.noDataTitle")),1),n("div",Xe,s(r(o)("invoicesPage.table.noDataHint")),1),l(P,{variant:"outlined",color:"secondary",onClick:H},{default:i(()=>[l(p,{icon:"tabler-refresh",class:"me-1"}),m(" "+s(r(o)("invoicesPage.filters.resetFilters")),1)]),_:1})])]),"item.invoice_number":i(({item:a})=>[l(R,{to:{name:"apps-invoice-preview-id",params:{id:a.id}}},{default:i(()=>[m(s(a.invoice_number),1)]),_:2},1032,["to"])]),"item.status":i(({item:a})=>[l(De,null,{activator:i(({props:_})=>[l(M,we({size:28},_,{color:X(a.status).variant,variant:"tonal"}),{default:i(()=>[l(p,{size:16,icon:X(a.status).icon},null,8,["icon"])]),_:2},1040,["color"])]),default:i(()=>[n("p",Ye,s(r(o)("invoicesPage.tooltip.status"))+": "+s(le(a.status)),1),n("p",Ge,s(r(o)("invoicesPage.tooltip.total"))+": SAR "+s(U(a.total)),1)]),_:2},1024)]),"item.client":i(({item:a})=>[n("div",Je,[l(M,{size:"34",color:"primary",variant:"tonal",class:"me-3"},{default:i(()=>[n("span",null,s(ae(a.client_name)),1)]),_:2},1024),n("div",Ke,[n("span",We,s(a.client_name),1),n("span",Ze,s(a.client_email),1),n("span",et,s(a.client_phone),1)])])]),"item.total":i(({item:a})=>[m("SAR "+s(U(a.total)),1)]),"item.issued_at":i(({item:a})=>[m(s(a.issued_at),1)]),"item.due_at":i(({item:a})=>[m(s(a.due_at),1)]),"item.actions":i(({item:a})=>[l(P,{icon:"",variant:"text",color:"medium-emphasis"},{default:i(()=>[l(p,{icon:"tabler-dots-vertical"}),l($e,{activator:"parent"},{default:i(()=>[l(Ae,null,{default:i(()=>[l(Z,{to:{name:"apps-invoice-preview-id",params:{id:a.id}}},{prepend:i(()=>[l(p,{icon:"tabler-eye"})]),default:i(()=>[l(ee,null,{default:i(()=>[m(s(r(o)("invoicesPage.actions.view")),1)]),_:1})]),_:2},1032,["to"]),l(Z,{onClick:_=>ne(a.id)},{prepend:i(()=>[l(p,{icon:"tabler-trash"})]),default:i(()=>[l(ee,null,{default:i(()=>[m(s(r(o)("invoicesPage.actions.delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:i(()=>[l(h,{page:f.value,"onUpdate:page":e[10]||(e[10]=a=>f.value=a),"items-per-page":v.value,"total-items":I.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["model-value","items-per-page","page","items-length","headers","items"])]),_:1})])}}};export{Jt as default};

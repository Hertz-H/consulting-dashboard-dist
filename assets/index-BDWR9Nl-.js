import{_ as de}from"./TablePagination-DMxhjePK.js";import{u as pe}from"./useApi-Dcbdi9nb.js";import{c as me}from"./createUrl-w7QDhdQJ.js";import{$ as fe}from"./api-CdP6DVdi.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as B,b as ee,d as _e}from"./VCard-CvoYH-tB.js";import{V as P}from"./VCardText--YnIOn_v.js";import{al as he,r as p,O as L,aX as xe,w as ge,c as g,b as t,e as o,o as b,d as l,a9 as m,t as n,l as r,s as u,F as be,h as ye,a2 as z}from"./index-C7qtdPxF.js";import{V as te}from"./VSpacer-BDvFYnO8.js";import{a as Ve,V as v}from"./VChip-0oIqGjbL.js";import{V as se}from"./VDivider-_zTHJTS9.js";import{V as Se}from"./VDataTableServer-BK3527GT.js";import{V as we}from"./VAlert-DSBjtW3E.js";import{V as Ce}from"./VTable-B4rWIEzF.js";import{V as ke}from"./VMenu-I2_LsuYP.js";import{V as Te,a as oe,b as ae}from"./VList-Dy3hiU5v.js";import{V as ze}from"./VDialog-DJVPmYlj.js";import{V as De}from"./VSnackbar-B-K0RDQC.js";import"./VPagination-BTWbNfov.js";import"./index-CvOPxmL5.js";import"./VAvatar-G0k920wU.js";import"./VImg-CqiRrtog.js";/* empty css              */import"./VSlideGroup-D5YnXd4F.js";import"./VDataTable-CkvRXYf-.js";import"./VSelect-LtwgNZ1_.js";import"./VTextField-BsIs5QE9.js";/* empty css                   */import"./VCounter-Cj1o1Vys.js";import"./VField-BqJwITnM.js";import"./VLabel-BL0IdVQU.js";import"./form-ZFmfzYYs.js";import"./easing-Bybner-F.js";import"./VInput-CbX7aBHh.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-Bjxq3jQa.js";import"./VOverlay-CWnbyjJr.js";import"./delay-DqFvUsxw.js";import"./lazy-CS65LDuN.js";import"./scopeId-CskrSFPb.js";import"./VCheckboxBtn-DtO76zpK.js";import"./VSelectionControl-B5WYu4tx.js";import"./filter-DjVrZkvV.js";import"./ssrBoot-DTheOfQd.js";const Ue={class:"services-page"},Ae={class:"d-flex align-center gap-3"},Ne={class:"heading-icon"},Be={class:"d-flex flex-column"},Pe={class:"text-body-1 font-weight-bold"},Le={class:"text-caption text-medium-emphasis"},Oe={class:"service-cell d-flex align-start gap-3"},Ie={class:"d-flex flex-column"},$e={class:"d-flex align-center gap-2"},je={class:"text-base font-weight-bold mb-0"},Ee={class:"text-sm text-medium-emphasis"},Fe=["colspan"],Me={class:"d-flex align-center gap-3"},qe={class:"expanded-icon"},Ge={class:"d-flex flex-column"},Je={class:"text-subtitle-1 font-weight-bold"},Re={class:"text-caption text-medium-emphasis"},Xe={key:0},He={key:1},Ke={class:"text-left"},Qe={class:"text-left"},We={class:"text-left"},Ye={class:"text-left"},Ze={class:"text-left"},et={class:"text-left"},tt={class:"font-weight-medium"},st={class:"text-medium-emphasis"},ot={class:"text-medium-emphasis"},at={key:0},lt={key:1,class:"text-disabled"},nt={class:"text-body-2"},h="success",it={__name:"index",async setup(rt){let C,O;const{t:i}=he(),S=p(""),y=p(10),x=p(1),D=p(),U=p(),I=p([]),$=p([]),k=p(!1),T=p(null),A=p(""),w=p(!1),N=p(!1),j=p(""),E=p("success"),F=(s,e="success")=>{j.value=s,E.value=e,N.value=!0},le=L(()=>[{title:i("consultationServices.headers.service"),key:"name"},{title:i("consultationServices.headers.consultationsCount"),key:"consultations_count"},{title:i("consultationServices.headers.actions"),key:"actions",sortable:!1}]),{data:M,execute:q}=([C,O]=xe(()=>pe(me("/v1/consultationTypes",{query:{status:S,page:x,per_page:y,sort_by:D,sort_order:U}}))),C=await C,O(),C);ge([S,y,x,D,U],()=>{q()});const G=L(()=>{var s;return((s=M.value)==null?void 0:s.data)??[]}),J=L(()=>{var e,c;const s=(c=(e=M.value)==null?void 0:e.meta)==null?void 0:c.total;return typeof s=="number"?s:G.value.length}),ne=s=>{var e,c;D.value=(e=s.sortBy[0])==null?void 0:e.key,U.value=(c=s.sortBy[0])==null?void 0:c.order,y.value=s.itemsPerPage,x.value=s.page};function V(s){let e="",c="";if(!s)return{ar:e,en:c};if(typeof s.ar=="string"&&(e=s.ar),typeof s.en=="string")try{const a=JSON.parse(s.en);a&&typeof a=="object"?(e=e||a.ar||"",c=a.en||""):c=s.en}catch{c=s.en}return{ar:e,en:c}}const R=s=>Number(s??0)===0?"warning":"primary",ie=(s="")=>{const e=(s||"").toLowerCase();return e==="draft"?"warning":e==="new"?"primary":e==="under study"||e==="under_study"?"info":e==="accepted"||e==="finished"?"success":"secondary"},f=s=>{const e=String(s??"");return e===""?{color:"secondary",icon:"tabler-layers-subtract"}:e==="2"?{color:"primary",icon:"tabler-sparkles"}:e==="3"?{color:"warning",icon:String(S.value??"")==="3"?"tabler-alert-triangle":"tabler-progress"}:e==="4"?{color:"success",icon:"tabler-circle-check"}:e==="5"?{color:"success",icon:"tabler-checks"}:{color:"secondary",icon:"tabler-filter"}},re=s=>{T.value=(s==null?void 0:s.id)??null;const e=V(s==null?void 0:s.name);A.value=(e==null?void 0:e.ar)||(e==null?void 0:e.en)||`#${(s==null?void 0:s.id)??""}`,k.value=!0},X=()=>{k.value=!1,T.value=null,A.value=""},ce=s=>{var d;const e=(d=s==null?void 0:s.response)==null?void 0:d.data,c=(e==null?void 0:e.message)||(e==null?void 0:e.error)||(e==null?void 0:e.msg)||"",a=e!=null&&e.errors?Object.values(e.errors).flat().filter(Boolean):[];return((a.length?a.join(`
`):"")||c||i("consultationServices.toast.deleteFailed")||"Failed to delete service").trim()},ue=async()=>{if(!(!T.value||w.value)){w.value=!0;try{await fe(`/v1/consultationTypes/${T.value}`,{method:"DELETE"}),F(i("consultationServices.toast.deleteSuccess"),"success"),X(),await q()}catch(s){F(ce(s),"error"),console.error("Failed to delete service",s)}finally{w.value=!1}}};return(s,e)=>{const c=de;return b(),g("section",Ue,[t(B,{class:"services-card"},{default:o(()=>[t(P,{class:"heading-bar d-flex flex-wrap align-center gap-4"},{default:o(()=>[l("div",Ae,[l("div",Ne,[t(m,{icon:"tabler-filter",size:"20",color:h})]),l("div",Be,[l("span",Pe,n(r(i)("consultationServices.title")),1),l("span",Le,n(r(i)("consultationServices.subtitle")),1)])]),t(te),t(Ve,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),class:"d-flex flex-wrap gap-2","selected-class":"chip-selected",mandatory:"false"},{default:o(()=>[t(v,{value:"",size:"small",label:"",variant:"tonal",color:f("").color,class:"filter-chip"},{default:o(()=>[t(m,{icon:f("").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.all")),1)]),_:1},8,["color"]),t(v,{value:"2",size:"small",label:"",variant:"tonal",color:f("2").color,class:"filter-chip"},{default:o(()=>[t(m,{icon:f("2").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.new")),1)]),_:1},8,["color"]),t(v,{value:"3",size:"small",label:"",variant:"tonal",color:f("3").color,class:"filter-chip"},{default:o(()=>[t(m,{icon:f("3").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.underStudy")),1)]),_:1},8,["color"]),t(v,{value:"4",size:"small",label:"",variant:"tonal",color:f("4").color,class:"filter-chip"},{default:o(()=>[t(m,{icon:f("4").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.accepted")),1)]),_:1},8,["color"]),t(v,{value:"5",size:"small",label:"",variant:"tonal",color:f("5").color,class:"filter-chip"},{default:o(()=>[t(m,{icon:f("5").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.finished")),1)]),_:1},8,["color"])]),_:1},8,["modelValue"])]),_:1}),t(se),t(Se,{"items-per-page":y.value,"onUpdate:itemsPerPage":e[2]||(e[2]=a=>y.value=a),"model-value":I.value,"onUpdate:modelValue":e[3]||(e[3]=a=>I.value=a),page:x.value,"onUpdate:page":e[4]||(e[4]=a=>x.value=a),expanded:$.value,"onUpdate:expanded":e[5]||(e[5]=a=>$.value=a),"show-expand":"","expand-on-click":"","items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],items:G.value,"items-length":J.value,headers:le.value,class:"text-no-wrap services-table","onUpdate:options":ne},{"item.name":o(({item:a})=>[l("div",Oe,[l("div",Ie,[l("div",$e,[l("h6",je,n(V(a.name).ar||V(a.name).en),1),t(v,{size:"x-small",label:"",variant:"tonal",color:"secondary",class:"service-id-chip"},{default:o(()=>[u(" #"+n(a.id),1)]),_:2},1024)]),l("div",Ee,n(V(a.name).en),1)])])]),"item.consultations_count":o(({item:a})=>[t(v,{color:R(a.consultations_count),size:"small",label:"",variant:"tonal",class:"font-weight-bold"},{default:o(()=>[u(n(a.consultations_count??0),1)]),_:2},1032,["color"])]),"item.actions":o(({item:a})=>[t(z,{icon:"",variant:"text",color:"medium-emphasis"},{default:o(()=>[t(m,{icon:"tabler-dots-vertical"}),t(ke,{activator:"parent",location:"bottom end"},{default:o(()=>[t(Te,{class:"py-1"},{default:o(()=>[t(oe,{to:{name:"apps-services-edit-id",params:{id:a.id}}},{prepend:o(()=>[t(m,{icon:"tabler-pencil",color:"medium-emphasis"})]),default:o(()=>[t(ae,{class:"font-weight-medium"},{default:o(()=>[u(n(r(i)("consultationServices.actions.edit")),1)]),_:1})]),_:2},1032,["to"]),t(oe,{onClick:_=>re(a)},{prepend:o(()=>[t(m,{icon:"tabler-trash",color:"medium-emphasis"})]),default:o(()=>[t(ae,{class:"font-weight-medium"},{default:o(()=>[u(n(r(i)("consultationServices.actions.delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"expanded-row":o(({columns:a,item:_})=>[l("tr",null,[l("td",{colspan:a.length},[t(B,{class:"ma-3 expanded-card",variant:"outlined"},{default:o(()=>[t(ee,{class:"d-flex align-center justify-space-between"},{default:o(()=>[l("div",Me,[l("div",qe,[t(m,{icon:"tabler-list-details",size:"18",color:h})]),l("div",Ge,[l("span",Je,n(r(i)("consultationServices.expanded.title")),1),l("span",Re,n(V(_.name).ar||V(_.name).en),1)])]),t(v,{size:"small",label:"",variant:"tonal",color:R(_.consultations_count)},{default:o(()=>[u(n(r(i)("consultationServices.expanded.totalLabel",{count:_.consultations_count??0})),1)]),_:2},1032,["color"])]),_:2},1024),t(se),t(P,null,{default:o(()=>[(_.consultations||[]).length===0?(b(),g("div",Xe,[t(we,{type:"success",variant:"tonal",class:"mb-0"},{default:o(()=>[u(n(r(i)("consultationServices.expanded.empty")),1)]),_:1})])):(b(),g("div",He,[t(Ce,{density:"compact",class:"expanded-table"},{default:o(()=>[l("thead",null,[l("tr",null,[e[8]||(e[8]=l("th",{class:"text-left"},"#",-1)),l("th",Ke,n(r(i)("consultationServices.expanded.columns.subject")),1),l("th",Qe,n(r(i)("consultationServices.expanded.columns.status")),1),l("th",We,n(r(i)("consultationServices.expanded.columns.date")),1),l("th",Ye,n(r(i)("consultationServices.expanded.columns.method")),1),l("th",Ze,n(r(i)("consultationServices.expanded.columns.price")),1),l("th",et,n(r(i)("consultationServices.expanded.columns.actions")),1)])]),l("tbody",null,[(b(!0),g(be,null,ye(_.consultations,d=>{var H,K;return b(),g("tr",{key:d.id},[l("td",null,n(d.consultation_number),1),l("td",tt,n(d.subject),1),l("td",null,[t(v,{color:ie((K=(H=d.status)==null?void 0:H.title)==null?void 0:K.en),size:"x-small",label:"",variant:"tonal"},{default:o(()=>{var Q,W,Y,Z;return[u(n(((W=(Q=d.status)==null?void 0:Q.title)==null?void 0:W.ar)||((Z=(Y=d.status)==null?void 0:Y.title)==null?void 0:Z.en)),1)]}),_:2},1032,["color"])]),l("td",st,n(d.date),1),l("td",ot,n(d.oppointment_method||"none"),1),l("td",null,[d.price?(b(),g("span",at,n(d.price),1)):(b(),g("span",lt,"-"))]),l("td",null,[t(z,{variant:"tonal",size:"small",color:h,to:{name:"apps-consultations-show-id",params:{id:d.id}}},{default:o(()=>[t(m,{icon:"tabler-eye",class:"me-1"}),u(" "+n(r(i)("consultationServices.actions.view")),1)]),_:2},1032,["to"])])])}),128))])]),_:2},1024)]))]),_:2},1024)]),_:2},1024)],8,Fe)])]),bottom:o(()=>[t(c,{page:x.value,"onUpdate:page":e[1]||(e[1]=a=>x.value=a),"items-per-page":y.value,"total-items":J.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","expanded","items","items-length","headers"]),t(ze,{modelValue:k.value,"onUpdate:modelValue":e[6]||(e[6]=a=>k.value=a),"max-width":"460"},{default:o(()=>[t(B,null,{default:o(()=>[t(ee,{class:"d-flex align-center gap-2"},{default:o(()=>[t(m,{icon:"tabler-alert-triangle",color:"warning"}),l("span",null,n(r(i)("consultationServices.confirm.title")),1)]),_:1}),t(P,null,{default:o(()=>[l("div",nt,n(r(i)("consultationServices.confirm.message",{name:A.value})),1)]),_:1}),t(_e,{class:"px-4 pb-4"},{default:o(()=>[t(te),t(z,{variant:"text",color:"secondary",disabled:w.value,onClick:X},{default:o(()=>[u(n(r(i)("consultationServices.confirm.cancel")),1)]),_:1},8,["disabled"]),t(z,{color:"error",variant:"flat",loading:w.value,onClick:ue},{default:o(()=>[u(n(r(i)("consultationServices.confirm.delete")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(De,{modelValue:N.value,"onUpdate:modelValue":e[7]||(e[7]=a=>N.value=a),color:E.value,timeout:"2500"},{default:o(()=>[u(n(j.value),1)]),_:1},8,["modelValue","color"])]),_:1})])}}},Zt=ve(it,[["__scopeId","data-v-fab485e4"]]);export{Zt as default};

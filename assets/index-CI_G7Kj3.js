import{_ as Ue}from"./TablePagination-DMxhjePK.js";import{_ as Ce}from"./AppDateTimePicker-Cs_usY5u.js";import{_ as $e}from"./AppSelect-CDuCHJJN.js";import{_ as Ae}from"./AppTextField-B_Hg2V0D.js";import{u as Te}from"./useApi-Dcbdi9nb.js";import{c as De}from"./createUrl-w7QDhdQJ.js";import{$ as M}from"./api-CdP6DVdi.js";import{V as ze}from"./VNavigationDrawer-BXjgVPmi.js";import{V as q}from"./VCard-CvoYH-tB.js";import{V as J,a as Se}from"./VToolbar-DC6uBGuH.js";import{V as W}from"./VSpacer-BDvFYnO8.js";import{al as Ne,r as c,w as H,O as y,aX as Le,c as U,b as s,e as l,a as Z,o as v,s as m,t as r,l as i,a2 as C,a9 as _,d as n,F as S,h as ee,f as N,k as te,v as ae}from"./index-C7qtdPxF.js";import{V as $}from"./VDivider-_zTHJTS9.js";import{V as Be}from"./VSheet-DN0xJD9A.js";import{V as se}from"./VCardText--YnIOn_v.js";import{V as le,a as oe}from"./VRow-B7mc-M76.js";import{V as ne}from"./VAvatar-G0k920wU.js";import{V as Oe}from"./VDataTableServer-BK3527GT.js";import{V as Ie}from"./VMenu-I2_LsuYP.js";import{V as Fe,a as K,b as R}from"./VList-Dy3hiU5v.js";import{V as re}from"./VChip-0oIqGjbL.js";import"./VPagination-BTWbNfov.js";import"./VField-BqJwITnM.js";import"./VLabel-BL0IdVQU.js";import"./form-ZFmfzYYs.js";import"./easing-Bybner-F.js";import"./VInput-CbX7aBHh.js";import"./VImg-CqiRrtog.js";import"./VSelect-LtwgNZ1_.js";import"./VTextField-BsIs5QE9.js";/* empty css                   */import"./VCounter-Cj1o1Vys.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-Bjxq3jQa.js";import"./VOverlay-CWnbyjJr.js";import"./delay-DqFvUsxw.js";import"./lazy-CS65LDuN.js";import"./scopeId-CskrSFPb.js";import"./VCheckboxBtn-DtO76zpK.js";import"./VSelectionControl-B5WYu4tx.js";import"./index-CvOPxmL5.js";import"./ssrBoot-DTheOfQd.js";/* empty css              */import"./VDataTable-CkvRXYf-.js";import"./VTable-B4rWIEzF.js";import"./filter-DjVrZkvV.js";import"./VSlideGroup-D5YnXd4F.js";const je={class:"text-body-2 font-weight-medium mb-1 d-block"},Me={class:"text-body-2 font-weight-medium mb-1 d-block"},qe={class:"text-body-2 font-weight-medium mb-1 d-block"},He={class:"text-body-2 font-weight-medium mb-1 d-block"},Ke={class:"d-flex justify-space-between mt-2"},Re={class:"d-flex flex-column"},Ee={class:"text-h4"},Qe={class:"text-body-1 text-capitalize"},Xe={class:"d-flex flex-column"},Ye={class:"text-h4"},Ge={class:"text-body-1 text-capitalize"},Je={class:"d-flex gap-4 align-center flex-wrap"},We={class:"d-flex align-center gap-2"},Ze={class:"text-medium-emphasis text-body-2"},et={class:"d-flex align-center gap-x-4"},tt={class:"d-flex flex-column"},at={class:"text-base"},st={class:"text-sm"},lt={class:"text-body-1 text-high-emphasis text-capitalize"},Zt={__name:"index",async setup(ot){let A,E;const{t:o}=Ne(),h=c(""),w=c(null),x=c(null),Q=c([]),P=c(!1),V=c(null),X=c(void 0),Y=c(void 0),p=c(10),f=c(1),L=c("id"),B=c("desc"),k=e=>{if(e)return e instanceof Date?e.toISOString().slice(0,10):String(e).slice(0,10)},ie=(e,t,u)=>{if(!e){t.value=void 0,u.value=void 0;return}if(Array.isArray(e)){const[g,j]=e;t.value=k(g),u.value=k(j);return}if(typeof e=="object"){t.value=k(e.start),u.value=k(e.end);return}if(typeof e=="string"){const g=e.split(" to ");t.value=k(g[0]||""),u.value=k(g[1]||"");return}t.value=void 0,u.value=void 0},ue=e=>{var u;f.value=e.page,p.value=e.itemsPerPage;const t=(u=e.sortBy)==null?void 0:u[0];L.value=(t==null?void 0:t.key)||"id",B.value=(t==null?void 0:t.order)||"desc"};H(V,e=>ie(e,X,Y),{immediate:!0});const ce=()=>{h.value="",w.value=null,x.value=null,V.value=null,f.value=1};H([h,w,x,V,p],()=>{f.value=1});const de=y(()=>[{title:o("roles.admin"),value:"admin"},{title:o("roles.client"),value:"client"},{title:o("roles.consultant"),value:"consultant"},{title:o("roles.consultantOffice"),value:"consultant-office"}]),me=y(()=>[{title:o("status.active"),value:1},{title:o("status.pending"),value:0},{title:o("status.inactive"),value:2}]),{data:O,execute:T}=([A,E]=Le(()=>Te(De("/v1/users",{query:{q:h,status:x,role:w||void 0,created_from:X,created_to:Y,page:f,per_page:p,sortBy:L,orderBy:B}}))),A=await A,E(),A);H([h,w,x,V,p,f,L,B],()=>{T()});const pe=y(()=>{var e;return((e=O.value)==null?void 0:e.data)??[]}),I=y(()=>{var e,t;return((t=(e=O.value)==null?void 0:e.meta)==null?void 0:t.total)??0}),b=y(()=>{var t;const e=(t=O.value)==null?void 0:t.summary;return{total:(e==null?void 0:e.total)??0,active:(e==null?void 0:e.active)??0,pending:(e==null?void 0:e.pending)??0,inactive:(e==null?void 0:e.inactive)??0,admins:(e==null?void 0:e.admins)??0,consultants:(e==null?void 0:e.consultants)??0,consultant_offices:(e==null?void 0:e.consultant_offices)??0,clients:(e==null?void 0:e.clients)??0}}),D=y(()=>[{title:o("usersPage.widgets.totalUsers"),value:b.value.total,icon:"tabler-users",color:"primary"},{title:o("usersPage.widgets.active"),value:b.value.active,icon:"tabler-user-check",color:"success"},{title:o("usersPage.widgets.pending"),value:b.value.pending,icon:"tabler-user-search",color:"warning"},{title:o("usersPage.widgets.inactive"),value:b.value.inactive,icon:"tabler-user-off",color:"secondary"}]),z=y(()=>[{title:o("usersPage.widgets.consultants"),value:b.value.consultants,icon:"tabler-user-check",color:"success"},{title:o("usersPage.widgets.consultantOffices"),value:b.value.consultant_offices,icon:"tabler-building-community",color:"info"},{title:o("usersPage.widgets.clients"),value:b.value.clients,icon:"tabler-user",color:"warning"},{title:o("usersPage.widgets.admins"),value:b.value.admins,icon:"tabler-crown",color:"primary"}]),fe={admin:"roles.admin",client:"roles.client",consultant:"roles.consultant","consultant-office":"roles.consultantOffice"},ve=e=>{const t=(e||"").trim();return t==="admin"?{color:"primary",icon:"tabler-crown"}:t==="client"?{color:"warning",icon:"tabler-user"}:t==="consultant"?{color:"success",icon:"tabler-user-check"}:t==="consultant-office"?{color:"info",icon:"tabler-building-community"}:{color:"secondary",icon:"tabler-user"}},F=e=>{if(e==null||e==="")return 2;if(typeof e=="number")return[0,1,2].includes(e)?e:2;const t=String(e).trim();if(t==="0"||t==="1"||t==="2")return Number(t);const u=t.toLowerCase();return u==="active"?1:u==="pending"?0:2},be={1:"status.active",0:"status.pending",2:"status.inactive"},ge=e=>{const t=F(e);return t===0?"warning":t===1?"success":t===2?"secondary":"primary"},ye=e=>{const t=F(e);return o(be[t]??"status.inactive")},_e=y(()=>[{title:o("common.users"),key:"user"},{title:o("common.phone"),key:"phone"},{title:o("common.roles"),key:"roles",sortable:!1},{title:o("common.status"),key:"status",sortable:!1},{title:o("common.actions"),key:"actions",sortable:!1}]),G=c(!1),he=async e=>{await M("/apps/users",{method:"POST",body:e}),T()},we=async e=>{await M(`/v1/users/${e}/deactivate`,{method:"PATCH"}),T()},xe=async e=>{await M(`/v1/users/${e}/activate`,{method:"PATCH"}),T()};return(e,t)=>{const u=Ae,g=$e,j=Ce,Ve=Z("RouterLink"),ke=Ue,Pe=Z("AddNewUserDrawer");return v(),U("section",null,[s(ze,{modelValue:P.value,"onUpdate:modelValue":t[6]||(t[6]=a=>P.value=a),location:"end",temporary:"",scrim:!1,width:"360",class:"users-filter-drawer",color:"background"},{default:l(()=>[s(J,{flat:""},{default:l(()=>[s(Se,null,{default:l(()=>[m(r(i(o)("common.filters")),1)]),_:1}),s(W),s(C,{icon:"",variant:"text",onClick:t[0]||(t[0]=a=>P.value=!1)},{default:l(()=>[s(_,{icon:"tabler-x"})]),_:1})]),_:1}),s($),s(Be,{class:"pa-4 d-flex flex-column gap-4 users-filter-sheet",elevation:"0"},{default:l(()=>[n("div",null,[n("span",je,r(i(o)("common.search")),1),s(u,{modelValue:h.value,"onUpdate:modelValue":t[1]||(t[1]=a=>h.value=a),placeholder:i(o)("usersPage.filters.searchPlaceholder"),density:"compact"},null,8,["modelValue","placeholder"])]),n("div",null,[n("span",Me,r(i(o)("common.status")),1),s(g,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=a=>x.value=a),items:me.value,placeholder:i(o)("usersPage.filters.statusPlaceholder"),clearable:"","clear-icon":"tabler-x",density:"compact"},null,8,["modelValue","items","placeholder"])]),n("div",null,[n("span",qe,r(i(o)("common.roles")),1),s(g,{modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=a=>w.value=a),items:de.value,placeholder:i(o)("usersPage.filters.rolePlaceholder"),clearable:"","clear-icon":"tabler-x",density:"compact"},null,8,["modelValue","items","placeholder"])]),n("div",null,[n("span",He,r(i(o)("usersPage.filters.createdRangeLabel")),1),s(j,{modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=a=>V.value=a),config:{mode:"range",dateFormat:"Y-m-d"},placeholder:i(o)("usersPage.filters.createdRangePlaceholder")},null,8,["modelValue","placeholder"])]),s($,{class:"my-2"}),n("div",Ke,[s(C,{variant:"outlined",color:"secondary",onClick:ce},{default:l(()=>[s(_,{icon:"tabler-refresh",class:"me-1"}),m(" "+r(i(o)("common.reset")),1)]),_:1}),s(C,{class:"users-filter-btn",variant:"text","prepend-icon":"tabler-filter",onClick:t[5]||(t[5]=a=>P.value=!1)},{default:l(()=>[m(r(i(o)("common.applyAndClose")),1)]),_:1})])]),_:1})]),_:1},8,["modelValue"]),s(q,{class:"mb-6"},{default:l(()=>[s(se,{class:"px-3"},{default:l(()=>[s(le,null,{default:l(()=>[(v(!0),U(S,null,ee(D.value,(a,d)=>(v(),U(S,{key:"top-"+d},[s(oe,{cols:"12",sm:"6",md:"3",class:"px-6"},{default:l(()=>[n("div",{class:ae(["d-flex justify-space-between align-center",e.$vuetify.display.xs?d!==D.value.length-1?"border-b pb-4":"":e.$vuetify.display.sm&&d<D.value.length/2?"border-b pb-4":""])},[n("div",Re,[n("h4",Ee,r(a.value),1),n("span",Qe,r(a.title),1)]),s(ne,{color:a.color,variant:"tonal",rounded:"",size:"42"},{default:l(()=>[s(_,{icon:a.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])],2)]),_:2},1024),(e.$vuetify.display.mdAndUp?d!==D.value.length-1:e.$vuetify.display.smAndUp&&d%2===0)?(v(),N($,{key:0,vertical:"",inset:"",length:"60"})):te("",!0)],64))),128))]),_:1})]),_:1})]),_:1}),s(q,{class:"mb-6"},{default:l(()=>[s(se,{class:"px-3"},{default:l(()=>[s(le,null,{default:l(()=>[(v(!0),U(S,null,ee(z.value,(a,d)=>(v(),U(S,{key:"bottom-"+d},[s(oe,{cols:"12",sm:"6",md:"3",class:"px-6"},{default:l(()=>[n("div",{class:ae(["d-flex justify-space-between align-center",e.$vuetify.display.xs?d!==z.value.length-1?"border-b pb-4":"":e.$vuetify.display.sm&&d<z.value.length/2?"border-b pb-4":""])},[n("div",Xe,[n("h4",Ye,r(a.value),1),n("span",Ge,r(a.title),1)]),s(ne,{color:a.color,variant:"tonal",rounded:"",size:"42"},{default:l(()=>[s(_,{icon:a.icon,size:"26"},null,8,["icon"])]),_:2},1032,["color"])],2)]),_:2},1024),e.$vuetify.display.mdAndUp&&d!==z.value.length-1?(v(),N($,{key:0,vertical:"",inset:"",length:"60"})):te("",!0)],64))),128))]),_:1})]),_:1})]),_:1}),s(q,{id:"users-list"},{default:l(()=>[s(J,{flat:"",density:"comfortable",class:"px-4"},{default:l(()=>[n("div",Je,[n("div",We,[n("span",null,r(i(o)("common.show")),1),s(g,{"model-value":p.value,items:[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"5.5rem"},"onUpdate:modelValue":t[7]||(t[7]=a=>p.value=parseInt(a,10))},null,8,["model-value"])]),n("span",Ze,r(i(o)("usersPage.table.totalUsersLabel",{count:I.value})),1)]),s(W),s(C,{class:"users-filter-btn",variant:"text","prepend-icon":"tabler-filter",onClick:t[8]||(t[8]=a=>P.value=!0)},{default:l(()=>[m(r(i(o)("common.filters")),1)]),_:1})]),_:1}),s($),s(Oe,{"model-value":Q.value,"onUpdate:modelValue":t[10]||(t[10]=a=>Q.value=a),"items-per-page":p.value,"onUpdate:itemsPerPage":t[11]||(t[11]=a=>p.value=a),page:f.value,"onUpdate:page":t[12]||(t[12]=a=>f.value=a),items:pe.value,"items-length":I.value,headers:_e.value,class:"text-no-wrap","onUpdate:options":ue},{"item.user":l(({item:a})=>[n("div",et,[n("div",tt,[n("h6",at,[s(Ve,{to:{name:"apps-user-view-id",params:{id:a.id}},class:"font-weight-medium text-link"},{default:l(()=>[m(r(a.name),1)]),_:2},1032,["to"])]),n("div",st,r(a.email),1)])])]),"item.phone":l(({item:a})=>[n("div",lt,r(a.phone),1)]),"item.roles":l(({item:a})=>[s(re,{color:ve(a.roles).color,size:"small",label:"",class:"text-capitalize"},{default:l(()=>[m(r(i(o)(fe[a.roles]??"roles.client")),1)]),_:2},1032,["color"])]),"item.status":l(({item:a})=>[s(re,{color:ge(a.status),size:"small",label:"",class:"text-capitalize"},{default:l(()=>[m(r(ye(a.status)),1)]),_:2},1032,["color"])]),"item.actions":l(({item:a})=>[s(C,{icon:"",variant:"text",color:"medium-emphasis"},{default:l(()=>[s(_,{icon:"tabler-dots-vertical"}),s(Ie,{activator:"parent"},{default:l(()=>[s(Fe,null,{default:l(()=>[s(K,{to:{name:"apps-user-view-id",params:{id:a.id}}},{prepend:l(()=>[s(_,{icon:"tabler-pencil"})]),default:l(()=>[s(R,null,{default:l(()=>[m(r(i(o)("common.edit")),1)]),_:1})]),_:2},1032,["to"]),Number(F(a.status))===1?(v(),N(K,{key:0,onClick:d=>we(a.id)},{prepend:l(()=>[s(_,{icon:"tabler-eye"})]),default:l(()=>[s(R,null,{default:l(()=>[m(r(i(o)("common.suspend")),1)]),_:1})]),_:2},1032,["onClick"])):(v(),N(K,{key:1,onClick:d=>xe(a.id)},{prepend:l(()=>[s(_,{icon:"tabler-eye"})]),default:l(()=>[s(R,null,{default:l(()=>[m(r(i(o)("common.activate")),1)]),_:1})]),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:l(()=>[s(ke,{page:f.value,"onUpdate:page":t[9]||(t[9]=a=>f.value=a),"items-per-page":p.value,"total-items":I.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["model-value","items-per-page","page","items","items-length","headers"])]),_:1}),s(Pe,{"is-drawer-open":G.value,"onUpdate:isDrawerOpen":t[13]||(t[13]=a=>G.value=a),onUserData:he},null,8,["is-drawer-open"])])}}};export{Zt as default};

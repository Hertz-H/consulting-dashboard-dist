import{_ as tt}from"./TablePagination-Cx-LG4gO.js";import{u as et}from"./globalStore-D2vVY3V9.js";import{bc as at,O as p,r as i,aW as ot,w as q,E as st,c as O,b as n,e as s,o as v,a2 as nt,a9 as y,f as w,k as x,s as u,l as it,t as l,d as c,F as rt}from"./index-_jCPV2aF.js";import{u as lt}from"./useApi-BSihX8I_.js";import{c as ut}from"./createUrl-DerIJZgq.js";import{V as ct}from"./VCard-CYfkfZlC.js";import{V as mt}from"./VDataTableServer-D_7BGN4U.js";import{V as dt}from"./VMenu-W6TaPzp1.js";import{V as pt,a as R,b as G}from"./VList-D79pGFA0.js";import{V as g}from"./VChip-BnBQvEXo.js";import"./VDivider-DjzWIV_C.js";import"./VPagination-3D2ppFv5.js";import"./api-CPmHFLjm.js";import"./index-CvOPxmL5.js";import"./VAvatar-BUdDAT-D.js";import"./VImg-DA0BPHG3.js";import"./VCardText-Cr9zYerb.js";import"./VDataTable-kyHWzpjD.js";import"./VSelect-BsK64aKW.js";import"./VTextField-CN2AZIMD.js";/* empty css                   */import"./VCounter-BcDhNrnV.js";import"./VField-91ynVj_P.js";import"./form-DfxPkTmm.js";import"./easing-Bybner-F.js";import"./VInput-8edLhH7M.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-DjPgznwY.js";import"./VOverlay-bMguoG5p.js";import"./delay-D2erLk9c.js";import"./lazy-CuyGI7DY.js";import"./scopeId-C0M2gTct.js";import"./VCheckboxBtn-C8_dhrEU.js";import"./VSelectionControl-D7pa1tqU.js";import"./VTable-DRb7ZGN7.js";import"./filter-CB9CejHc.js";import"./ssrBoot-DOlwUK_M.js";import"./VSlideGroup-C7HvQrxv.js";const yt={class:"d-flex flex-column"},_t={class:"text-base font-weight-medium text-link"},ft={class:"text-body-1"},vt={class:"text-body-1"},gt={class:"text-body-1"},bt={class:"text-body-1"},ht={class:"d-flex align-center gap-2"},ie={__name:"index",async setup(xt){let b,L;const r=et(),Q=at(),_=p(()=>r.currentLanguage),m=(o,t)=>{const a=t||_.value;return o==null?"—":typeof o=="string"?o:o[a]??o.en??o.ar??"—"},W=o=>{const t=typeof o=="object"?o.en||o.ar||"":o||"";return String(t).trim().toLowerCase()},C=i(""),S=i(),$=i(),B=i(),j=i(),z=i(),f=i(10),d=i(1),k=i(),V=i(),D=i([]),H=o=>{var t,a;k.value=(t=o.sortBy[0])==null?void 0:t.key,V.value=(a=o.sortBy[0])==null?void 0:a.order},h=o=>{const t=String(o||"").toLowerCase();return t==="chat"?{icon:"tabler-message-circle",color:"info",label:"Chat"}:t==="session"?{icon:"tabler-video",color:"success",label:"Session"}:{icon:"tabler-circle-dashed",color:"secondary",label:"—"}},J=[{title:"Consultation Number",key:"consultation_number"},{title:"Subject",key:"subject"},{title:"Date",key:"date"},{title:"Activity",key:"activity"},{title:"Type",key:"type"},{title:"Method",key:"method"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],{data:P,execute:X}=([b,L]=ot(()=>lt(ut("/v1/consultations",{query:{q:C,subject:S||void 0,status:B||void 0,activity:j||void 0,type:z||void 0,itemsPerPage:f,page:d,sortBy:k,orderBy:V}}))),b=await b,L(),b);q([C,S,$,B,j,z,f,d,k,V],()=>X());const Y=p(()=>{var t;const o=_.value;return(((t=P.value)==null?void 0:t.data)||[]).map(a=>{var T,U,N,F,K,M,E,I;const e=W((T=a.status)==null?void 0:T.title);return{id:a.id,consultation_number:a.consultation_number,subject:a.subject||"—",description:a.description||"—",date:a.date,attachments_count:((U=a.attachments)==null?void 0:U.length)||0,activity:m((N=a.activity)==null?void 0:N.name,o),type:m((F=a.type)==null?void 0:F.name,o),status:m((K=a.status)==null?void 0:K.title,o),status_id:((M=a.status)==null?void 0:M.id)||null,method:a.oppointment_method||"none",method_date:a.oppointment_date||null,method_time:a.oppointment_time||null,method_url:a.oppointment_url||null,_activity_id:((E=a.activity)==null?void 0:E.id)||a.activity_id,_type_id:((I=a.type)==null?void 0:I.id)||a.type_id,_statusKey:e}})}),A=p(()=>{var o,t;return((t=(o=P.value)==null?void 0:o.meta)==null?void 0:t.total)||0});p(()=>{const o=r.activities||[],t=_.value;return o.map(a=>({title:m(a.name,t)||"—",value:a.id}))}),p(()=>{const o=r.consultations_types||[],t=_.value;return o.map(a=>({title:m(a.name,t)||"—",value:a.id}))}),st(async()=>{var o,t,a;(!((o=r.activities)!=null&&o.length)||!((t=r.consultations_types)!=null&&t.length)||!((a=r.consultations_statuses)!=null&&a.length))&&await r.fetchFeedData()}),q(()=>r.currentLanguage,()=>{r.fetchFeedData()}),p(()=>{const o=r.consultations_statuses||[],t=_.value;return o.map(a=>{var e;return{title:m(a.title||a.name,t)||"—",value:a.id??a.slug??a.key??((e=a.name)==null?void 0:e.toLowerCase())??""}})});const Z=o=>{const t=String(o||"").toLowerCase();return t==="pending"?"warning":t==="closed"?"success":t==="new"?"info":t==="archived"?"secondary":t==="draft"?"info":"primary"};return(o,t)=>{const a=tt;return v(),O("section",null,[n(ct,null,{default:s(()=>[n(mt,{"items-per-page":f.value,"onUpdate:itemsPerPage":t[1]||(t[1]=e=>f.value=e),"model-value":D.value,"onUpdate:modelValue":t[2]||(t[2]=e=>D.value=e),page:d.value,"onUpdate:page":t[3]||(t[3]=e=>d.value=e),items:Y.value,"items-length":A.value,headers:J,class:"text-no-wrap","onUpdate:options":H},{"item.consultation_number":s(({item:e})=>[c("div",yt,[c("h6",_t,l(e.consultation_number),1)])]),"item.subject":s(({item:e})=>[c("div",ft,l(e.subject),1)]),"item.date":s(({item:e})=>[c("div",vt,l(e.date),1)]),"item.activity":s(({item:e})=>[c("div",gt,l(e.activity),1)]),"item.type":s(({item:e})=>[c("div",bt,l(e.type),1)]),"item.method":s(({item:e})=>[c("div",ht,[n(g,{color:h(e.method).label==="—"?"secondary":h(e.method).color,size:"small",label:"",class:"text-capitalize"},{default:s(()=>[n(y,{icon:h(e.method).icon,class:"me-1"},null,8,["icon"]),u(" "+l(h(e.method).label),1)]),_:2},1032,["color"]),e.method&&e.method!=="none"?(v(),O(rt,{key:0},[e.method_date?(v(),w(g,{key:0,size:"x-small",variant:"tonal",color:"primary"},{default:s(()=>[n(y,{icon:"tabler-calendar",class:"me-1"}),u(" "+l(e.method_date),1)]),_:2},1024)):x("",!0),e.method_time?(v(),w(g,{key:1,size:"x-small",variant:"tonal",color:"primary"},{default:s(()=>[n(y,{icon:"tabler-clock",class:"me-1"}),u(" "+l(e.method_time),1)]),_:2},1024)):x("",!0)],64)):x("",!0)])]),"item.attachments_count":s(({item:e})=>[n(g,{size:"small",color:e.attachments_count>0?"primary":"secondary",label:""},{default:s(()=>[u(l(e.attachments_count),1)]),_:2},1032,["color"])]),"item.status":s(({item:e})=>[n(g,{color:Z(e._statusKey),size:"small",label:"",class:"text-capitalize"},{default:s(()=>[u(l(e.status),1)]),_:2},1032,["color"])]),"item.actions":s(({item:e})=>[n(nt,{icon:"",variant:"text",color:"medium-emphasis"},{default:s(()=>[n(y,{icon:"tabler-dots-vertical"}),n(dt,{activator:"parent"},{default:s(()=>[n(pt,null,{default:s(()=>[n(R,{to:{name:"apps-consultations-show-id",params:{id:e.id}}},{prepend:s(()=>[n(y,{icon:"tabler-eye"})]),default:s(()=>[n(G,null,{default:s(()=>t[4]||(t[4]=[u("View")])),_:1,__:[4]})]),_:2},1032,["to"]),it(Q).can("update","consultation")&&e.status_id==1?(v(),w(R,{key:0,to:{name:"apps-consultations-edit-id",params:{id:e.id}}},{prepend:s(()=>[n(y,{icon:"tabler-pencil"})]),default:s(()=>[n(G,null,{default:s(()=>t[5]||(t[5]=[u("Edit")])),_:1,__:[5]})]),_:2},1032,["to"])):x("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:s(()=>[n(a,{page:d.value,"onUpdate:page":t[0]||(t[0]=e=>d.value=e),"items-per-page":f.value,"total-items":A.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}};export{ie as default};

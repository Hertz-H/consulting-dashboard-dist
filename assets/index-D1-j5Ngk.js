import{_ as de}from"./TablePagination-BS9zVhTb.js";import{u as pe}from"./useApi-B07hdb0V.js";import{c as me}from"./createUrl-Ch6EJdVn.js";import{$ as fe}from"./api-BtdnJSD2.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as O,b as ee,d as _e}from"./VCard-Bp3Y2g69.js";import{V as I}from"./VCardText-CNPcEnqc.js";import{al as he,r as d,O as $,aX as ge,w as xe,c as x,b as s,e as o,o as b,d as l,a9 as m,t as n,l as r,s as u,F as be,h as ye,a2 as U}from"./index-DLyiUI4T.js";import{V as te}from"./VSpacer-DoPoSCZt.js";import{a as Ve,V as v}from"./VChip-C_HpRD3G.js";import{V as se}from"./VDivider-DZkdhmn8.js";import{V as Se}from"./VDataTableServer-oIz8JhZR.js";import{V as we}from"./VAlert-vA7Wbf13.js";import{V as Ce}from"./VTable-C-5dAhBS.js";import{V as ke}from"./VMenu-CnM5Ce9N.js";import{V as Te,a as oe,b as ae}from"./VList-BLAOQF4q.js";import{V as ze}from"./VDialog-BcSlizvS.js";import{V as De}from"./VSnackbar-TawvNeit.js";import"./VPagination-CevEurIF.js";import"./index-CvOPxmL5.js";import"./VAvatar-GwUQM--D.js";import"./VImg-W922IUCz.js";/* empty css              */import"./VSlideGroup-BBTw8Lc6.js";import"./VDataTable-CZ-vN8BX.js";import"./VSelect-xtg9jf9g.js";import"./VTextField-D_VDXh9N.js";/* empty css                   */import"./VCounter-DSUdNhJf.js";import"./VField-DJvLbBqg.js";import"./VLabel-Bj0ZLaaG.js";import"./form-4FzIkTDC.js";import"./easing-Bybner-F.js";import"./VInput-CZKa1bvG.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-B2cZjoh4.js";import"./VOverlay-BpuXFPpY.js";import"./delay-CJQMA8o3.js";import"./lazy-D7mfu-eq.js";import"./scopeId-BqXwnYFS.js";import"./VCheckboxBtn-DpT_qdyT.js";import"./VSelectionControl-DGmCswqu.js";import"./filter-sNEpt0hK.js";import"./ssrBoot-Co57-A6O.js";const Ue={class:"services-page"},Ae={class:"d-flex align-center gap-3"},Ne={class:"heading-icon"},Be={class:"d-flex flex-column"},Pe={class:"text-body-1 font-weight-bold"},Le={class:"text-caption text-medium-emphasis"},Oe={class:"service-cell d-flex align-start gap-3"},Ie={class:"d-flex flex-column"},$e={class:"d-flex align-center gap-2"},je={class:"text-base font-weight-bold mb-0"},Ee={class:"text-sm text-medium-emphasis"},Fe=["colspan"],Me={class:"d-flex align-center gap-3"},qe={class:"expanded-icon"},Ge={class:"d-flex flex-column"},Je={class:"text-subtitle-1 font-weight-bold"},Re={class:"text-caption text-medium-emphasis"},Xe={key:0},He={key:1},Ke={class:"text-left"},Qe={class:"text-left"},We={class:"text-left"},Ye={class:"text-left"},Ze={class:"text-left"},et={class:"text-left"},tt={class:"font-weight-medium"},st={class:"text-medium-emphasis"},ot={class:"text-medium-emphasis"},at={key:0},lt={key:1,class:"text-disabled"},nt={class:"text-body-2"},h="success",it={__name:"index",async setup(rt){let T,j;const{t:i}=he(),S=d(""),y=d(10),g=d(1),A=d(),N=d(),E=d([]),F=d([]),z=d(!1),D=d(null),B=d(""),w=d(!1),P=d(!1),M=d(""),q=d("success"),G=(t,e="success")=>{M.value=t,q.value=e,P.value=!0},le=$(()=>[{title:i("consultationServices.headers.service"),key:"name"},{title:i("consultationServices.headers.consultationsCount"),key:"consultations_count"},{title:i("consultationServices.headers.actions"),key:"actions",sortable:!1}]),{data:J,execute:R}=([T,j]=ge(()=>pe(me("/v1/consultationTypes",{query:{status:S,page:g,per_page:y,sort_by:A,sort_order:N}}))),T=await T,j(),T);xe([S,y,g,A,N],()=>{R()});const X=$(()=>{var t;return((t=J.value)==null?void 0:t.data)??[]}),H=$(()=>{var e,c;const t=(c=(e=J.value)==null?void 0:e.meta)==null?void 0:c.total;return typeof t=="number"?t:X.value.length}),ne=t=>{var e,c;A.value=(e=t.sortBy[0])==null?void 0:e.key,N.value=(c=t.sortBy[0])==null?void 0:c.order,y.value=t.itemsPerPage,g.value=t.page};function V(t){let e="",c="";if(!t)return{ar:e,en:c};if(typeof t.ar=="string"&&(e=t.ar),typeof t.en=="string")try{const a=JSON.parse(t.en);a&&typeof a=="object"?(e=e||a.ar||"",c=a.en||""):c=t.en}catch{c=t.en}return{ar:e,en:c}}const K=t=>Number(t??0)===0?"warning":"primary",ie=(t="")=>{const e=(t||"").toLowerCase();return e==="draft"?"warning":e==="new"?"primary":e==="under study"||e==="under_study"?"info":e==="accepted"||e==="finished"?"success":"secondary"},f=t=>{const e=String(t??"");return e===""?{color:"secondary",icon:"tabler-layers-subtract"}:e==="2"?{color:"primary",icon:"tabler-sparkles"}:e==="3"?{color:"warning",icon:String(S.value??"")==="3"?"tabler-alert-triangle":"tabler-progress"}:e==="4"?{color:"success",icon:"tabler-circle-check"}:e==="5"?{color:"success",icon:"tabler-checks"}:{color:"secondary",icon:"tabler-filter"}},re=t=>{D.value=(t==null?void 0:t.id)??null;const e=V(t==null?void 0:t.name);B.value=(e==null?void 0:e.ar)||(e==null?void 0:e.en)||`#${(t==null?void 0:t.id)??""}`,z.value=!0},L=()=>{z.value=!1,D.value=null,B.value=""},ce=t=>{var C,k;const e=((C=t==null?void 0:t.response)==null?void 0:C.data)??((k=t==null?void 0:t.response)==null?void 0:k._data)??(t==null?void 0:t.data)??(t==null?void 0:t._data)??null,c=(e==null?void 0:e.message)||(e==null?void 0:e.error)||(e==null?void 0:e.msg)||(t==null?void 0:t.message)||"",a=e!=null&&e.errors?Object.values(e.errors).flat().filter(Boolean):[];return((a.length?a.join(`
`):"")||c||(typeof e=="string"?e:"")||i("consultationServices.toast.deleteFailed")||"Failed to delete service").trim()},ue=async()=>{if(!(!D.value||w.value)){w.value=!0;try{await fe(`/v1/consultationTypes/${D.value}`,{method:"DELETE"}),G(i("consultationServices.toast.deleteSuccess"),"success"),L(),await R()}catch(t){G(ce(t),"error"),L(),console.error("Failed to delete service",t)}finally{w.value=!1}}};return(t,e)=>{const c=de;return b(),x("section",Ue,[s(O,{class:"services-card"},{default:o(()=>[s(I,{class:"heading-bar d-flex flex-wrap align-center gap-4"},{default:o(()=>[l("div",Ae,[l("div",Ne,[s(m,{icon:"tabler-filter",size:"20",color:h})]),l("div",Be,[l("span",Pe,n(r(i)("consultationServices.title")),1),l("span",Le,n(r(i)("consultationServices.subtitle")),1)])]),s(te),s(Ve,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),class:"d-flex flex-wrap gap-2","selected-class":"chip-selected",mandatory:"false"},{default:o(()=>[s(v,{value:"",size:"small",label:"",variant:"tonal",color:f("").color,class:"filter-chip"},{default:o(()=>[s(m,{icon:f("").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.all")),1)]),_:1},8,["color"]),s(v,{value:"2",size:"small",label:"",variant:"tonal",color:f("2").color,class:"filter-chip"},{default:o(()=>[s(m,{icon:f("2").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.new")),1)]),_:1},8,["color"]),s(v,{value:"3",size:"small",label:"",variant:"tonal",color:f("3").color,class:"filter-chip"},{default:o(()=>[s(m,{icon:f("3").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.underStudy")),1)]),_:1},8,["color"]),s(v,{value:"4",size:"small",label:"",variant:"tonal",color:f("4").color,class:"filter-chip"},{default:o(()=>[s(m,{icon:f("4").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.accepted")),1)]),_:1},8,["color"]),s(v,{value:"5",size:"small",label:"",variant:"tonal",color:f("5").color,class:"filter-chip"},{default:o(()=>[s(m,{icon:f("5").icon,size:"14",class:"me-1",color:h},null,8,["icon"]),u(" "+n(r(i)("consultationServices.filters.finished")),1)]),_:1},8,["color"])]),_:1},8,["modelValue"])]),_:1}),s(se),s(Se,{"items-per-page":y.value,"onUpdate:itemsPerPage":e[2]||(e[2]=a=>y.value=a),"model-value":E.value,"onUpdate:modelValue":e[3]||(e[3]=a=>E.value=a),page:g.value,"onUpdate:page":e[4]||(e[4]=a=>g.value=a),expanded:F.value,"onUpdate:expanded":e[5]||(e[5]=a=>F.value=a),"show-expand":"","expand-on-click":"","items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],items:X.value,"items-length":H.value,headers:le.value,class:"text-no-wrap services-table","onUpdate:options":ne},{"item.name":o(({item:a})=>[l("div",Oe,[l("div",Ie,[l("div",$e,[l("h6",je,n(V(a.name).ar||V(a.name).en),1),s(v,{size:"x-small",label:"",variant:"tonal",color:"secondary",class:"service-id-chip"},{default:o(()=>[u(" #"+n(a.id),1)]),_:2},1024)]),l("div",Ee,n(V(a.name).en),1)])])]),"item.consultations_count":o(({item:a})=>[s(v,{color:K(a.consultations_count),size:"small",label:"",variant:"tonal",class:"font-weight-bold"},{default:o(()=>[u(n(a.consultations_count??0),1)]),_:2},1032,["color"])]),"item.actions":o(({item:a})=>[s(U,{icon:"",variant:"text",color:"medium-emphasis"},{default:o(()=>[s(m,{icon:"tabler-dots-vertical"}),s(ke,{activator:"parent",location:"bottom end"},{default:o(()=>[s(Te,{class:"py-1"},{default:o(()=>[s(oe,{to:{name:"apps-services-edit-id",params:{id:a.id}}},{prepend:o(()=>[s(m,{icon:"tabler-pencil",color:"medium-emphasis"})]),default:o(()=>[s(ae,{class:"font-weight-medium"},{default:o(()=>[u(n(r(i)("consultationServices.actions.edit")),1)]),_:1})]),_:2},1032,["to"]),s(oe,{onClick:_=>re(a)},{prepend:o(()=>[s(m,{icon:"tabler-trash",color:"medium-emphasis"})]),default:o(()=>[s(ae,{class:"font-weight-medium"},{default:o(()=>[u(n(r(i)("consultationServices.actions.delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"expanded-row":o(({columns:a,item:_})=>[l("tr",null,[l("td",{colspan:a.length},[s(O,{class:"ma-3 expanded-card",variant:"outlined"},{default:o(()=>[s(ee,{class:"d-flex align-center justify-space-between"},{default:o(()=>[l("div",Me,[l("div",qe,[s(m,{icon:"tabler-list-details",size:"18",color:h})]),l("div",Ge,[l("span",Je,n(r(i)("consultationServices.expanded.title")),1),l("span",Re,n(V(_.name).ar||V(_.name).en),1)])]),s(v,{size:"small",label:"",variant:"tonal",color:K(_.consultations_count)},{default:o(()=>[u(n(r(i)("consultationServices.expanded.totalLabel",{count:_.consultations_count??0})),1)]),_:2},1032,["color"])]),_:2},1024),s(se),s(I,null,{default:o(()=>[(_.consultations||[]).length===0?(b(),x("div",Xe,[s(we,{type:"success",variant:"tonal",class:"mb-0"},{default:o(()=>[u(n(r(i)("consultationServices.expanded.empty")),1)]),_:1})])):(b(),x("div",He,[s(Ce,{density:"compact",class:"expanded-table"},{default:o(()=>[l("thead",null,[l("tr",null,[e[8]||(e[8]=l("th",{class:"text-left"},"#",-1)),l("th",Ke,n(r(i)("consultationServices.expanded.columns.subject")),1),l("th",Qe,n(r(i)("consultationServices.expanded.columns.status")),1),l("th",We,n(r(i)("consultationServices.expanded.columns.date")),1),l("th",Ye,n(r(i)("consultationServices.expanded.columns.method")),1),l("th",Ze,n(r(i)("consultationServices.expanded.columns.price")),1),l("th",et,n(r(i)("consultationServices.expanded.columns.actions")),1)])]),l("tbody",null,[(b(!0),x(be,null,ye(_.consultations,p=>{var C,k;return b(),x("tr",{key:p.id},[l("td",null,n(p.consultation_number),1),l("td",tt,n(p.subject),1),l("td",null,[s(v,{color:ie((k=(C=p.status)==null?void 0:C.title)==null?void 0:k.en),size:"x-small",label:"",variant:"tonal"},{default:o(()=>{var Q,W,Y,Z;return[u(n(((W=(Q=p.status)==null?void 0:Q.title)==null?void 0:W.ar)||((Z=(Y=p.status)==null?void 0:Y.title)==null?void 0:Z.en)),1)]}),_:2},1032,["color"])]),l("td",st,n(p.date),1),l("td",ot,n(p.oppointment_method||"none"),1),l("td",null,[p.price?(b(),x("span",at,n(p.price),1)):(b(),x("span",lt,"-"))]),l("td",null,[s(U,{variant:"tonal",size:"small",color:h,to:{name:"apps-consultations-show-id",params:{id:p.id}}},{default:o(()=>[s(m,{icon:"tabler-eye",class:"me-1"}),u(" "+n(r(i)("consultationServices.actions.view")),1)]),_:2},1032,["to"])])])}),128))])]),_:2},1024)]))]),_:2},1024)]),_:2},1024)],8,Fe)])]),bottom:o(()=>[s(c,{page:g.value,"onUpdate:page":e[1]||(e[1]=a=>g.value=a),"items-per-page":y.value,"total-items":H.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","expanded","items","items-length","headers"]),s(ze,{modelValue:z.value,"onUpdate:modelValue":e[6]||(e[6]=a=>z.value=a),"max-width":"460"},{default:o(()=>[s(O,null,{default:o(()=>[s(ee,{class:"d-flex align-center gap-2"},{default:o(()=>[s(m,{icon:"tabler-alert-triangle",color:"warning"}),l("span",null,n(r(i)("consultationServices.confirm.title")),1)]),_:1}),s(I,null,{default:o(()=>[l("div",nt,n(r(i)("consultationServices.confirm.message",{name:B.value})),1)]),_:1}),s(_e,{class:"px-4 pb-4"},{default:o(()=>[s(te),s(U,{variant:"text",color:"secondary",disabled:w.value,onClick:L},{default:o(()=>[u(n(r(i)("consultationServices.confirm.cancel")),1)]),_:1},8,["disabled"]),s(U,{color:"error",variant:"flat",loading:w.value,onClick:ue},{default:o(()=>[u(n(r(i)("consultationServices.confirm.delete")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(De,{modelValue:P.value,"onUpdate:modelValue":e[7]||(e[7]=a=>P.value=a),color:q.value,location:"top right",timeout:"2500"},{default:o(()=>[u(n(M.value),1)]),_:1},8,["modelValue","color"])]),_:1})])}}},Zt=ve(it,[["__scopeId","data-v-ec9ca288"]]);export{Zt as default};

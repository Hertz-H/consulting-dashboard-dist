import{_ as q}from"./TablePagination-DdJ4S-xc.js";import{al as z,r as n,aX as F,O as g,w as O,c as B,b as o,e as a,i as E,o as v,d as l,a2 as H,a9 as h,f as Q,k as $,s as u,t as i,l as P,v as A}from"./index-DQmZf-Xj.js";import{u as X}from"./useApi-Ct-6W-lY.js";import{c as G}from"./createUrl-B9xqrxdL.js";import{$ as J}from"./api-DE6DUsJ_.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as W}from"./VCard-C_4VJn-8.js";import{V as Y}from"./VCardText-BRVadkC6.js";import{V as Z}from"./VSpacer-DvIbVmMT.js";import{V as ee}from"./VDivider-DdQ5ZGaf.js";import{V as te}from"./VDataTableServer-DG8ATzzf.js";import{V as ae}from"./VMenu-D3tTBXxA.js";import{V as se,a as T,b as D}from"./VList-C6mR20Ba.js";import{V as oe}from"./VChip-MuDwaTxO.js";import"./VPagination-DB0ECNje.js";import"./index-CvOPxmL5.js";import"./VAvatar-BSaP2aJ4.js";import"./VImg-DOcWVjej.js";/* empty css              */import"./VDataTable-CPT08wR-.js";import"./VSelect-Bhu0lvyB.js";import"./VTextField-CLE0haGg.js";/* empty css                   */import"./VCounter-n4uRWdM2.js";import"./VField-D4ioAJ5d.js";import"./VLabel-DGDnQGXC.js";import"./form-Bo4elXah.js";import"./easing-Bybner-F.js";import"./VInput-DjvCNQyc.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-kbiQFXWj.js";import"./VOverlay-dQ2rZt_z.js";import"./delay-DgqARyzl.js";import"./lazy-BUeLM-Y3.js";import"./scopeId-A6e6jMOB.js";import"./VCheckboxBtn-BwzO9Ng7.js";import"./VSelectionControl-C8NAjBaP.js";import"./VTable-Dgj5a2wM.js";import"./filter-CUzo-_Rb.js";import"./ssrBoot-DAbQuRUP.js";import"./VSlideGroup-D5H4D9Mv.js";const re={class:"d-flex gap-2 align-center w-100"},ie={class:"d-flex align-center gap-2"},le={key:0,class:"rounded-circle",style:{width:"8px",height:"8px","background-color":"#1976d2"}},me={class:"d-flex flex-column"},ne={class:"text-xs text-medium-emphasis truncate-2-lines"},pe=["href"],ce=["href"],de={__name:"index",async setup(ue){let c,y;const U=E(),{t:r}=z(),b=n(""),p=n(10),m=n(1),_=n(),f=n(),x=n([]),{data:V,execute:k}=([c,y]=F(()=>X(G("/v1/contact-messages",{query:{q:b,page:m,per_page:p,sortBy:_,orderBy:f}}))),c=await c,y(),c),I=t=>{var s,d;_.value=(s=t.sortBy[0])==null?void 0:s.key,f.value=(d=t.sortBy[0])==null?void 0:d.order},R=g(()=>[{title:r("messagesList.table.company"),key:"company_name"},{title:r("messagesList.table.subject"),key:"subject"},{title:r("messagesList.table.email"),key:"email"},{title:r("messagesList.table.phone"),key:"phone"},{title:r("messagesList.table.status"),key:"is_read"},{title:r("messagesList.table.receivedAt"),key:"created_at"},{title:r("messagesList.table.actions"),key:"actions",sortable:!1}]),S=g(()=>{var t;return((t=V.value)==null?void 0:t.data)??[]}),w=g(()=>{var t,s;return((s=(t=V.value)==null?void 0:t.meta)==null?void 0:s.total)??0}),j=t=>{if(!t)return"-";try{return new Date(t).toLocaleString()}catch{return t}},L=t=>t?{color:"success",label:r("messagesList.status.viewed")}:{color:"primary",label:r("messagesList.status.new")};O([b,p,m,_,f],()=>{k()});const C=async t=>{try{await J(`/v1/contact-messages/${t}/read`,{method:"PATCH"}),await k()}catch(s){console.error("Failed to mark message as read",s)}},M=async t=>{t.is_read||await C(t.id),U.push({name:"apps-messages-view-id",params:{id:t.id}})};return(t,s)=>{const d=q;return v(),B("section",null,[o(W,null,{default:a(()=>[o(Y,{class:"d-flex flex-wrap gap-4"},{default:a(()=>[l("div",re,[o(Z)])]),_:1}),o(ee),o(te,{"items-per-page":p.value,"onUpdate:itemsPerPage":s[1]||(s[1]=e=>p.value=e),"model-value":x.value,"onUpdate:modelValue":s[2]||(s[2]=e=>x.value=e),page:m.value,"onUpdate:page":s[3]||(s[3]=e=>m.value=e),"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],items:S.value,"items-length":w.value,headers:R.value,class:"text-no-wrap","onUpdate:options":I},{"item.company_name":a(({item:e})=>[l("div",ie,[e.is_read?$("",!0):(v(),B("span",le)),l("span",{class:A([{"font-weight-bold":!e.is_read}])},i(e.company_name||"-"),3)])]),"item.subject":a(({item:e})=>[l("div",me,[l("span",{class:A([{"font-weight-bold":!e.is_read}])},i(e.subject),3),l("span",ne,i(e.message),1)])]),"item.email":a(({item:e})=>[l("a",{href:`mailto:${e.email}`,class:"text-link"},i(e.email),9,pe)]),"item.phone":a(({item:e})=>[l("a",{href:`tel:${e.phone}`,class:"text-link"},i(e.phone),9,ce)]),"item.is_read":a(({item:e})=>[o(oe,{color:L(e.is_read).color,size:"small",label:""},{default:a(()=>[u(i(L(e.is_read).label),1)]),_:2},1032,["color"])]),"item.created_at":a(({item:e})=>[u(i(j(e.created_at)),1)]),"item.actions":a(({item:e})=>[o(H,{icon:"",variant:"text",color:"medium-emphasis"},{default:a(()=>[o(h,{icon:"tabler-dots-vertical"}),o(ae,{activator:"parent"},{default:a(()=>[o(se,null,{default:a(()=>[o(T,{onClick:N=>M(e)},{prepend:a(()=>[o(h,{icon:"tabler-eye"})]),default:a(()=>[o(D,null,{default:a(()=>[u(i(P(r)("messagesList.actions.view")),1)]),_:1})]),_:2},1032,["onClick"]),e.is_read?$("",!0):(v(),Q(T,{key:0,onClick:N=>C(e.id)},{prepend:a(()=>[o(h,{icon:"tabler-mail-opened"})]),default:a(()=>[o(D,null,{default:a(()=>[u(i(P(r)("messagesList.actions.markAsRead")),1)]),_:1})]),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:a(()=>[o(d,{page:m.value,"onUpdate:page":s[0]||(s[0]=e=>m.value=e),"items-per-page":p.value,"total-items":w.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length","headers"])]),_:1})])}}},tt=K(de,[["__scopeId","data-v-f9c7943d"]]);export{tt as default};

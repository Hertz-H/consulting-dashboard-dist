import{_ as tt}from"./TablePagination-BS9zVhTb.js";import{u as et}from"./globalStore-BwaKJnmg.js";import{aL as at,O as f,r as i,aX as ot,w as q,E as st,c as O,b as n,e as s,o as d,a2 as nt,a9 as c,f as b,k as h,s as u,l as it,t as r,d as m,F as lt}from"./index-DLyiUI4T.js";import{u as rt}from"./useApi-B07hdb0V.js";import{c as ut}from"./createUrl-Ch6EJdVn.js";import{V as ct}from"./VCard-Bp3Y2g69.js";import{V as dt}from"./VDataTableServer-oIz8JhZR.js";import{V as mt}from"./VMenu-CnM5Ce9N.js";import{V as pt,a as R,b as G}from"./VList-BLAOQF4q.js";import{V as p}from"./VChip-C_HpRD3G.js";import"./VDivider-DZkdhmn8.js";import"./VPagination-CevEurIF.js";import"./api-BtdnJSD2.js";import"./index-CvOPxmL5.js";import"./VAvatar-GwUQM--D.js";import"./VImg-W922IUCz.js";import"./VCardText-CNPcEnqc.js";import"./VDataTable-CZ-vN8BX.js";import"./VSelect-xtg9jf9g.js";import"./VTextField-D_VDXh9N.js";/* empty css                   */import"./VCounter-DSUdNhJf.js";import"./VField-DJvLbBqg.js";import"./VLabel-Bj0ZLaaG.js";import"./form-4FzIkTDC.js";import"./easing-Bybner-F.js";import"./VInput-CZKa1bvG.js";import"./forwardRefs-C-GTDzx5.js";import"./dialog-transition-B2cZjoh4.js";import"./VOverlay-BpuXFPpY.js";import"./delay-CJQMA8o3.js";import"./lazy-D7mfu-eq.js";import"./scopeId-BqXwnYFS.js";import"./VCheckboxBtn-DpT_qdyT.js";import"./VSelectionControl-DGmCswqu.js";import"./VTable-C-5dAhBS.js";import"./filter-sNEpt0hK.js";import"./ssrBoot-Co57-A6O.js";import"./VSlideGroup-BBTw8Lc6.js";const _t={class:"d-flex flex-column"},yt={class:"text-base font-weight-medium text-link"},ft={class:"text-body-1"},vt={class:"text-body-1"},gt={class:"text-body-1"},bt={class:"text-body-1"},ht={class:"d-flex align-center gap-2"},le={__name:"index",async setup(xt){let x,L;const l=et(),Q=at(),v=f(()=>l.currentLanguage),_=(o,e)=>{const a=e||v.value;return o==null?"—":typeof o=="string"?o:o[a]??o.en??o.ar??"—"},X=o=>{const e=typeof o=="object"?o.en||o.ar||"":o||"";return String(e).trim().toLowerCase()},C=i(""),S=i(),$=i(),B=i(),j=i(),z=i(),g=i(10),y=i(1),V=i(),w=i(),D=i([]),H=o=>{var e,a;V.value=(e=o.sortBy[0])==null?void 0:e.key,w.value=(a=o.sortBy[0])==null?void 0:a.order},k=o=>{const e=String(o||"").toLowerCase();return e==="chat"?{icon:"tabler-message-circle",color:"info",label:"Chat"}:e==="session"?{icon:"tabler-video",color:"success",label:"Session"}:{icon:"tabler-circle-dashed",color:"secondary",label:"none"}},J=[{title:"Consultation Number",key:"consultation_number"},{title:"Subject",key:"subject"},{title:"Date",key:"date"},{title:"Activity",key:"activity"},{title:"Type",key:"type"},{title:"Method",key:"method"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],{data:P,execute:W}=([x,L]=ot(()=>rt(ut("/v1/my-consultations",{query:{q:C,subject:S||void 0,status:B||void 0,activity:j||void 0,type:z||void 0,itemsPerPage:g,page:y,sortBy:V,orderBy:w}}))),x=await x,L(),x);q([C,S,$,B,j,z,g,y,V,w],()=>W());const Y=f(()=>{var e;const o=v.value;return(((e=P.value)==null?void 0:e.data)||[]).map(a=>{var T,U,N,F,K,M,E,I;const t=X((T=a.status)==null?void 0:T.title);return{id:a.id,consultation_number:a.consultation_number,subject:a.subject||"—",description:a.description||"—",date:a.date,attachments_count:((U=a.attachments)==null?void 0:U.length)||0,activity:_((N=a.activity)==null?void 0:N.name,o),type:_((F=a.type)==null?void 0:F.name,o),status:_((K=a.status)==null?void 0:K.title,o),status_id:((M=a.status)==null?void 0:M.id)||null,method:a.oppointment_method||"none",method_date:a.oppointment_date||null,method_time:a.oppointment_time||null,method_url:a.oppointment_url||null,_activity_id:((E=a.activity)==null?void 0:E.id)||a.activity_id,_type_id:((I=a.type)==null?void 0:I.id)||a.type_id,_statusKey:t}})}),A=f(()=>{var o,e;return((e=(o=P.value)==null?void 0:o.meta)==null?void 0:e.total)||0});f(()=>{const o=l.activities||[],e=v.value;return o.map(a=>({title:_(a.name,e)||"—",value:a.id}))}),f(()=>{const o=l.consultations_types||[],e=v.value;return o.map(a=>({title:_(a.name,e)||"—",value:a.id}))}),st(async()=>{var o,e,a;(!((o=l.activities)!=null&&o.length)||!((e=l.consultations_types)!=null&&e.length)||!((a=l.consultations_statuses)!=null&&a.length))&&await l.fetchFeedData()}),q(()=>l.currentLanguage,()=>{l.fetchFeedData()}),f(()=>{const o=l.consultations_statuses||[],e=v.value;return o.map(a=>{var t;return{title:_(a.title||a.name,e)||"—",value:a.id??a.slug??a.key??((t=a.name)==null?void 0:t.toLowerCase())??""}})});const Z=o=>{const e=String(o||"").toLowerCase();return e==="pending"?"warning":e==="closed"?"success":e==="new"?"info":e==="archived"?"secondary":e==="draft"?"info":"primary"};return(o,e)=>{const a=tt;return d(),O("section",null,[n(ct,null,{default:s(()=>[n(dt,{"items-per-page":g.value,"onUpdate:itemsPerPage":e[1]||(e[1]=t=>g.value=t),"model-value":D.value,"onUpdate:modelValue":e[2]||(e[2]=t=>D.value=t),page:y.value,"onUpdate:page":e[3]||(e[3]=t=>y.value=t),items:Y.value,"items-length":A.value,headers:J,class:"text-no-wrap","onUpdate:options":H},{"item.consultation_number":s(({item:t})=>[m("div",_t,[m("h6",yt,r(t.consultation_number),1)])]),"item.subject":s(({item:t})=>[m("div",ft,r(t.subject),1)]),"item.date":s(({item:t})=>[m("div",vt,r(t.date),1)]),"item.activity":s(({item:t})=>[m("div",gt,r(t.activity),1)]),"item.type":s(({item:t})=>[m("div",bt,r(t.type),1)]),"item.method":s(({item:t})=>[m("div",ht,[n(p,{color:k(t.method).label==="none"?"secondary":k(t.method).color,size:"small",label:"",class:"text-capitalize"},{default:s(()=>[n(c,{icon:k(t.method).icon,class:"me-1"},null,8,["icon"]),u(" "+r(k(t.method).label),1)]),_:2},1032,["color"]),t.method&&t.method!=="none"?(d(),O(lt,{key:0},[t.method_date?(d(),b(p,{key:0,size:"x-small",variant:"tonal",color:"primary"},{default:s(()=>[n(c,{icon:"tabler-calendar",class:"me-1"}),u(" "+r(t.method_date),1)]),_:2},1024)):h("",!0),t.method_time?(d(),b(p,{key:1,size:"x-small",variant:"tonal",color:"primary"},{default:s(()=>[n(c,{icon:"tabler-clock",class:"me-1"}),u(" "+r(t.method_time),1)]),_:2},1024)):h("",!0),t.method==="session"&&t.method_url&&t.status_id==5?(d(),b(p,{key:2,size:"x-small",variant:"tonal",color:"success",href:t.method_url,target:"_blank",tag:"a",class:"text-decoration-none"},{default:s(()=>[n(c,{icon:"tabler-external-link",class:"me-1"}),e[4]||(e[4]=u(" Link "))]),_:2,__:[4]},1032,["href"])):t.method==="chat"&&t.status_id==5?(d(),b(p,{key:3,size:"x-small",variant:"tonal",color:"success",tag:"a",class:"text-decoration-none",to:{name:"apps-consultations-chat-id",params:{id:t.id}}},{default:s(()=>[n(c,{icon:"tabler-external-link",class:"me-1"}),e[5]||(e[5]=u(" chat "))]),_:2,__:[5]},1032,["to"])):h("",!0)],64)):h("",!0)])]),"item.attachments_count":s(({item:t})=>[n(p,{size:"small",color:t.attachments_count>0?"primary":"secondary",label:""},{default:s(()=>[u(r(t.attachments_count),1)]),_:2},1032,["color"])]),"item.status":s(({item:t})=>[n(p,{color:Z(t._statusKey),size:"small",label:"",class:"text-capitalize"},{default:s(()=>[u(r(t.status),1)]),_:2},1032,["color"])]),"item.actions":s(({item:t})=>[n(nt,{icon:"",variant:"text",color:"medium-emphasis"},{default:s(()=>[n(c,{icon:"tabler-dots-vertical"}),n(mt,{activator:"parent"},{default:s(()=>[n(pt,null,{default:s(()=>[n(R,{to:{name:"apps-consultations-show-id",params:{id:t.id}}},{prepend:s(()=>[n(c,{icon:"tabler-eye"})]),default:s(()=>[n(G,null,{default:s(()=>e[6]||(e[6]=[u("View")])),_:1,__:[6]})]),_:2},1032,["to"]),it(Q).can("update","consultation")&&t.status_id==1?(d(),b(R,{key:0,to:{name:"apps-consultations-edit-id",params:{id:t.id}}},{prepend:s(()=>[n(c,{icon:"tabler-pencil"})]),default:s(()=>[n(G,null,{default:s(()=>e[7]||(e[7]=[u("Edit")])),_:1,__:[7]})]),_:2},1032,["to"])):h("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:s(()=>[n(a,{page:y.value,"onUpdate:page":e[0]||(e[0]=t=>y.value=t),"items-per-page":g.value,"total-items":A.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}};export{le as default};

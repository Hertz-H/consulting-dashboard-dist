import{r as c,c3 as l,aM as n,c4 as u}from"./index-Df0vDIYO.js";const s=c(null);function d(){return s.value}function i(){s.value=null}const h="__sess_meta_auth_";function p(){localStorage.removeItem(h)}const m=l({baseUrl:"https://control.smrt-consulting.net/api",fetchOptions:{headers:{Accept:"application/json","Content-Type":"application/json"}},options:{refetch:!0,async beforeFetch({options:o}){const t=n("accessToken").value;return t&&(o.headers={...o.headers,Authorization:`Bearer ${t}`}),{options:o}},afterFetch(o){const{data:t,response:e}=o;let r=null;try{r=u(t)}catch(a){console.error(a)}return{data:r,response:e}},onFetchError(o){const{response:t}=o;if(t&&t.status===401){try{i(),p(),localStorage.removeItem("tokenExpireAt"),localStorage.removeItem("user");const e=n("accessToken"),r=n("userData"),a=n("userAbilityRules");e.value=null,r.value=null,a.value=null}catch(e){console.error("Error clearing auth data:",e)}if(typeof window<"u"){const e=window.location.pathname;e!=="/login"&&e!=="/login-2"&&setTimeout(()=>{window.location.href=`/login${e!=="/"?`?to=${encodeURIComponent(e)}`:""}`},0)}}return o}}});export{i as c,d as g,m as u};
